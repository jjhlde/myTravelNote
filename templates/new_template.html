<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>마카오 가족여행</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
        }
        .gradient-text {
            background-image: linear-gradient(45deg, #F57C00, #FFB74D);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .page-container {
            display: flex;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .page-content {
            flex-shrink: 0;
            width: 100%;
        }
        .nav-tab.active {
            color: #F57C00;
            font-weight: 700;
            border-color: #F57C00;
        }
        .bottom-sheet {
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .bottom-sheet.active {
            transform: translateY(0);
        }
        .overlay {
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none;
        }
        .overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        .slider-arrow {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .image-slider-container:hover .slider-arrow {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto max-w-lg min-h-screen bg-white shadow-2xl shadow-slate-200 flex flex-col relative overflow-hidden">
        
        <!-- 상단 헤더 (고정) -->
        <header id="main-header" class="sticky top-0 z-20 bg-white/95 backdrop-blur-lg border-b border-slate-100">
            <div class="p-6 flex justify-between items-center">
                <div class="flex-1 min-w-0">
                    <h1 id="main-title" class="text-lg font-bold text-slate-900 truncate"></h1>
                    <p id="main-subtitle" class="text-xs text-slate-500 truncate"></p>
                </div>
                <button class="w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 transition flex items-center justify-center flex-shrink-0 ml-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
                </button>
            </div>
            <!-- 스크롤형 탭 네비게이션 -->
            <div id="top-nav" class="px-4 border-t border-slate-100">
                <div class="flex items-center gap-4 overflow-x-auto no-scrollbar">
                    <!-- Day Tabs will be generated by JS -->
                </div>
            </div>
        </header>

        <!-- 메인 콘텐츠 영역 (스와이프 가능) -->
        <main class="flex-1 overflow-hidden">
            <div id="page-container" class="page-container h-full">
                <!-- Day Pages will be generated by JS -->
            </div>
        </main>

        <!-- 떠있는 하단 탭 -->
        <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 z-30">
            <div id="bottom-nav" class="flex items-center gap-2 bg-white/70 backdrop-blur-xl p-2 rounded-full shadow-lg ring-1 ring-black/5">
                <button data-sheet="info" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                    <span class="text-xs font-medium">정보</span>
                </button>
                <button data-sheet="budget" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                     <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                    <span class="text-xs font-medium">예산</span>
                </button>
                <button data-sheet="todo" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                    <span class="text-xs font-medium">준비물</span>
                </button>
            </div>
        </nav>

        <!-- 바텀 시트 오버레이 -->
        <div id="overlay" class="overlay fixed inset-0 bg-black/40 z-40"></div>

        <!-- 정보 바텀 시트 -->
        <div id="sheet-info" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">여행 정보</h2>
                <div class="space-y-4" id="info-cards">
                    <!-- Info Cards will be generated by JS -->
                </div>
            </div>
        </div>
        
        <!-- 예산 바텀 시트 -->
        <div id="sheet-budget" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">여행 예산</h2>
                <div class="space-y-6">
                    <div class="bg-slate-100 p-5 rounded-xl">
                        <div class="flex justify-between items-center mb-2">
                            <div>
                                <h3 class="font-bold text-slate-800 flex items-center gap-2">
                                    총 예산
                                    <button id="edit-budget-btn" class="text-slate-400 hover:text-orange-500">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path></svg>
                                    </button>
                                </h3>
                                <p id="total-budget-display" class="text-xs text-slate-500"></p>
                            </div>
                            <span id="total-expense" class="font-bold text-orange-600 text-lg"></span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-2.5">
                            <div id="expense-progress" class="bg-gradient-to-r from-orange-400 to-amber-500 h-2.5 rounded-full transition-all" style="width: 0%"></div>
                        </div>
                    </div>
                    <div id="expense-list" class="space-y-3">
                        <!-- Expense items will be added here -->
                    </div>
                    <div>
                        <h3 class="font-bold text-slate-800 mt-8 mb-4 border-b pb-2">지출 추가</h3>
                        <div class="space-y-3">
                            <input id="expense-item" type="text" placeholder="항목 (예: 저녁 식사)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <input id="expense-amount" type="number" placeholder="금액 (원)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <button id="add-expense-btn" class="w-full bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">추가하기</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 준비물 바텀 시트 -->
        <div id="sheet-todo" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">여행 준비물</h2>
                <div id="todo-list-container" class="space-y-6">
                    <!-- Todo categories and items will be generated by JS -->
                </div>
                 <div class="mt-8 flex gap-2">
                    <input id="new-todo-item" type="text" placeholder="새 준비물 추가" class="flex-1 p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                    <button id="add-todo-btn" class="bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">추가</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        const travelData = { "tripMeta": { "destination": "Macau", "duration": "2박 3일", "startDate": "2024-07-30", "endDate": "2024-08-01", "tripType": "family", "planConfidence": 0.85 }, "mainPlan": { "planId": "main", "planName": "아이와 함께하는 여유로운 마카오 가족 여행", "description": "37개월 아이의 리듬에 맞춰 그랜드 리조트 덱을 중심으로 설계된 편안하고 즐거운 가족 여행 일정입니다.", "dailyPlans": [ { "day": 1, "date": "2024-07-30", "dayTheme": "도착과 그랜드 리조트 덱의 즐거움", "activities": [ { "id": "day1-activity1", "time": "14:00", "duration": 90, "type": "transport", "title": "마카오 도착 및 갤럭시 마카오 체크인", "description": "마카오 국제공항(MFM) 도착 후, 갤럭시 마카오 무료 셔틀버스를 이용하여 호텔로 이동합니다. 체크인 후 잠시 휴식을 취하며 아이의 컨디션을 조절합니다.", "tips": [ "공항에서 호텔 셔틀버스를 이용하면 편리하고 무료입니다.", "체크인 전 짐을 맡기고 리조트 시설을 미리 둘러볼 수 있습니다." ], "placeDetails": { "placeId": "ChIJWcXn5g1wATQRDGP94RbxDu0", "name": "갤럭시호텔", "address": "Galaxy Macau, G/F, 마카오", "rating": 4.5, "photos": [ "https://placehold.co/600x300/667eea/ffffff?text=Galaxy+Hotel+1", "https://placehold.co/600x300/764ba2/ffffff?text=Galaxy+Hotel+2" ], "reviews": "\"최고의 서비스를 추구하는 호텔...\" (5⭐)", "website": "https://www.galaxymacau.com/", "mapLink": "https://maps.google.com/?q=22.1489092,113.5543443" } }, { "id": "day1-activity2", "time": "16:00", "duration": 180, "type": "activity", "title": "그랜드 리조트 덱에서 신나는 물놀이", "description": "아이와 함께 그랜드 리조트 덱의 파도풀, 유수풀, 워터 슬라이드 등 다양한 시설을 즐기며 시원한 시간을 보냅니다.", "tips": [ "어린 아이를 위한 구명조끼와 튜브를 준비하거나 현장에서 대여 가능합니다." ], "placeDetails": { "name": "그랜드 리조트 덱", "address": "갤럭시 마카오 내부", "rating": 4.8, "photos": [ "https://placehold.co/600x300/38bdf8/ffffff?text=Water+Park+1", "https://placehold.co/600x300/06b6d4/ffffff?text=Water+Park+2" ], "reviews": "\"아이와 함께라면 최고의 선택! 하루 종일 놀아도 지루하지 않아요.\" (5⭐)", "website": "https://www.galaxymacau.com/", "mapLink": "https://maps.google.com/?q=22.1489092,113.5543443" } } ] }, { "day": 2, "date": "2024-07-31", "dayTheme": "마카오의 역사와 아이들을 위한 즐거움", "activities": [ { "id": "day2-activity1", "time": "09:30", "duration": 90, "type": "sightseeing", "title": "세나도 광장 & 성 바울 성당 유적", "description": "마카오의 상징적인 유적지를 방문하여 사진을 찍고 역사적인 분위기를 느껴봅니다.", "tips": [ "오전 일찍 방문하여 인파를 피하는 것이 좋습니다." ], "placeDetails": { "name": "세나도 광장", "address": "Senado Square, 마카오", "rating": 4.3, "photos": [ "https://placehold.co/600x300/34d399/ffffff?text=Senado+Square" ], "reviews": "\"홍콩&마카오에서 가장 유럽 분위기 나는 장소였어요!\" (4⭐)", "website": "http://www.culturalheritage.mo/", "mapLink": "https://maps.google.com/?q=22.1935334,113.5397593" } } ] }, { "day": 3, "date": "2024-08-01", "dayTheme": "마지막 즐거움과 아쉬운 작별", "activities": [ { "id": "day3-activity1", "time": "09:30", "duration": 120, "type": "activity", "title": "호텔 시설 재방문 또는 쇼핑", "description": "출국 전 마지막으로 그랜드 리조트 덱에서 물놀이를 즐기거나, 쇼핑 아케이드에서 기념품을 구입합니다.", "tips": [ "체크아웃 후 짐을 맡기고 시설을 이용할 수 있는지 호텔에 문의하세요." ] } ] } ] }, "alternativePlans": { "weather": { "planId": "weather", "planName": "비 오는 날/더운 날 플랜", "modifiedActivities": [ { "originalId": "day2-activity1", "newActivity": { "title": "마카오 과학관 방문", "type": "sightseeing", "description": "아이들이 흥미를 느낄 만한 다양한 과학 체험 시설이 있는 실내 박물관입니다." } } ] } }, "budgetBreakdown": { "total": { "value": 1500000, "currency": "KRW", "unit": "family" } }, "essentialInfo": { "weather": "7월 말 ~ 8월 초 마카오는 매우 덥고 습합니다.", "transportation": "주요 호텔들은 무료 셔틀버스를 운행합니다.", "mustTryFood": [ "에그타르트", "포르투갈식 치킨", "돼지고기 커틀릿 버거" ], "localTips": [ "실내 온도가 낮으니 얇은 겉옷을 꼭 챙기세요." ] } };

        document.addEventListener('DOMContentLoaded', () => {
            const navContainer = document.querySelector('#top-nav .flex');
            const pageContainer = document.getElementById('page-container');
            const bottomNav = document.getElementById('bottom-nav');
            const overlay = document.getElementById('overlay');
            const bottomSheets = { info: document.getElementById('sheet-info'), budget: document.getElementById('sheet-budget'), todo: document.getElementById('sheet-todo'), };
            let currentPageIndex = 0;
            
            const activityIcons = {
                transport: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-2.2-1.8-4-4-4H6c-2.2 0-4 1.8-4 4v3c0 .6.4 1 1 1h2"></path><circle cx="9" cy="17" r="2"></circle><circle cx="15" cy="17" r="2"></circle></svg>`, color: 'bg-blue-500' },
                hotel: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>`, color: 'bg-teal-500' },
                meal: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M17 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M3 13v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-8"></path></svg>`, color: 'bg-amber-500' },
                activity: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72z"></path><path d="m14 7 3 3"></path></svg>`, color: 'bg-rose-500' },
                sightseeing: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>`, color: 'bg-purple-500' },
            };

            function renderApp() {
                document.getElementById('main-title').textContent = `🇲🇴 ${travelData.tripMeta.destination} 가족여행`;
                document.getElementById('main-subtitle').textContent = travelData.mainPlan.description;
                
                pageContainer.innerHTML = '';
                navContainer.innerHTML = '';
                travelData.mainPlan.dailyPlans.forEach((dayPlan, index) => {
                    let activitiesHtml = dayPlan.activities.map(act => {
                        const iconInfo = activityIcons[act.type] || { icon: '', color: 'bg-slate-500' };
                        const imagesHtml = act.placeDetails && act.placeDetails.photos ? `
                            <div class="relative -mx-5 mb-4 rounded-lg overflow-hidden image-slider-container">
                                <div class="flex overflow-x-auto snap-x snap-mandatory no-scrollbar image-list">
                                    ${act.placeDetails.photos.map(src => `<div class="snap-center flex-shrink-0 w-full"><img src="${src}" class="w-full h-auto" alt="${act.title}"></div>`).join('')}
                                </div>
                                <div class="absolute bottom-3 left-0 right-0 flex justify-center gap-2 slider-dots"></div>
                                <button class="slider-arrow absolute top-1/2 left-2 -translate-y-1/2 bg-black/30 text-white w-8 h-8 rounded-full flex items-center justify-center prev-btn">&lt;</button>
                                <button class="slider-arrow absolute top-1/2 right-2 -translate-y-1/2 bg-black/30 text-white w-8 h-8 rounded-full flex items-center justify-center next-btn">&gt;</button>
                            </div>` : '';
                        
                        const detailsHtml = act.placeDetails ? `
                            <div class="space-y-3 pt-2">
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-amber-500">${act.placeDetails.rating}</span>
                                    <div class="flex text-amber-400">${'★'.repeat(Math.round(act.placeDetails.rating || 0))}${'☆'.repeat(5 - Math.round(act.placeDetails.rating || 0))}</div>
                                </div>
                                <div class="flex items-start gap-2 text-sm text-slate-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0 mt-0.5"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                                    <span>${act.placeDetails.address}</span>
                                </div>
                                <div class="border-t border-slate-100 pt-3">
                                    <p class="text-xs text-slate-500 mb-1">"${act.placeDetails.reviews.split('|')[0]}"</p>
                                </div>
                                <div class="mt-4 flex gap-3">
                                    <a href="${act.placeDetails.mapLink}" target="_blank" class="flex-1 text-center bg-orange-50 text-orange-700 text-sm font-bold py-2 px-4 rounded-lg hover:bg-orange-100 transition">지도 보기</a>
                                    <a href="${act.placeDetails.website}" target="_blank" class="flex-1 text-center bg-slate-100 text-slate-700 text-sm font-bold py-2 px-4 rounded-lg hover:bg-slate-200 transition">웹사이트</a>
                                </div>
                            </div>
                        ` : `<p class="text-sm text-slate-600 leading-relaxed">${act.description}</p>`;
                        
                        const tipsHtml = act.tips && act.tips.length > 0 ? `<div class="mt-4 border-t border-slate-100 pt-3"><h4 class="text-xs font-bold text-slate-500 mb-2">💡 전문가 팁</h4><ul class="list-disc list-inside text-xs text-slate-500 space-y-1">${act.tips.map(tip => `<li>${tip}</li>`).join('')}</ul></div>` : '';

                        return `<div class="relative pl-12"><div class="absolute left-0 top-1.5 flex items-center"><div class="w-8 h-8 ${iconInfo.color} rounded-full flex items-center justify-center ring-4 ring-white">${iconInfo.icon}</div></div><div class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm"><p class="text-sm font-semibold text-gray-500 mb-1">${act.time} (${act.duration}분)</p><h3 class="text-lg font-bold mb-3">${act.title}</h3>${imagesHtml}${detailsHtml}${tipsHtml}</div></div>`;
                    }).join('');
                    
                    const pageDiv = document.createElement('div');
                    pageDiv.className = 'page-content h-full overflow-y-auto p-6';
                    pageDiv.innerHTML = `<div class="mb-8"><h2 class="text-3xl font-extrabold gradient-text">DAY ${dayPlan.day}</h2><p class="text-slate-500 font-medium">${dayPlan.dayTheme}</p></div><div class="relative"><div class="absolute left-4 top-2 bottom-2 w-0.5 bg-slate-200"></div><div class="space-y-8">${activitiesHtml}</div></div>`;
                    pageContainer.appendChild(pageDiv);

                    const navTab = document.createElement('button');
                    navTab.className = 'nav-tab py-4 px-2 text-sm font-medium text-slate-500 border-b-2 border-transparent whitespace-nowrap';
                    navTab.textContent = `DAY ${dayPlan.day}`;
                    navTab.dataset.index = index;
                    navContainer.appendChild(navTab);
                });
                
                const infoCardsContainer = document.getElementById('info-cards');
                const infoCards = [
                    { title: '항공편', icon: '✈️', content: '인천(ICN) ↔ 마카오(MFM)', bg: 'bg-blue-50' },
                    { title: '숙소', icon: '🏨', content: '안다즈 마카오 (Andaz Macau)', bg: 'bg-green-50' },
                    { title: '여행 팁', icon: '💡', content: travelData.essentialInfo.localTips.join('<br>'), bg: 'bg-yellow-50' },
                    { title: '주의점', icon: '⚠️', content: travelData.essentialInfo.weather, bg: 'bg-red-50' },
                    { title: '🌍 현지 문화 팁', icon: '🌍', content: `<b>꼭 먹어봐야 할 음식:</b><br>${travelData.essentialInfo.mustTryFood.join(', ')}`, bg: 'bg-purple-50' }
                ];
                infoCardsContainer.innerHTML = infoCards.map(card => `<div class="p-5 ${card.bg} rounded-xl"><h3 class="font-bold text-slate-800 mb-3 text-lg">${card.icon} ${card.title}</h3><p class="text-sm text-slate-600 leading-relaxed">${card.content}</p></div>`).join('');
            }

            const navTabs = document.querySelectorAll('.nav-tab');
            const switchPage = (index) => {
                currentPageIndex = index;
                pageContainer.style.transform = `translateX(-${index * 100}%)`;
                navTabs.forEach((tab, i) => tab.classList.toggle('active', i === index));
                const activeTab = navTabs[index];
                activeTab.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                initializeSliders();
            };
            navContainer.addEventListener('click', (e) => { if (e.target.classList.contains('nav-tab')) { switchPage(parseInt(e.target.dataset.index)); } });
            
            let touchStartX = 0;
            pageContainer.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; });
            pageContainer.addEventListener('touchend', (e) => {
                const touchEndX = e.changedTouches[0].screenX;
                if (touchEndX < touchStartX - 50 && currentPageIndex < navTabs.length - 1) { switchPage(currentPageIndex + 1); }
                if (touchEndX > touchStartX + 50 && currentPageIndex > 0) { switchPage(currentPageIndex - 1); }
            });

            const openSheet = (sheetId) => {
                Object.values(bottomSheets).forEach(sheet => sheet.classList.remove('active'));
                if (bottomSheets[sheetId]) { bottomSheets[sheetId].classList.add('active'); overlay.classList.add('active'); }
            };
            const closeSheets = () => {
                Object.values(bottomSheets).forEach(sheet => sheet.classList.remove('active'));
                overlay.classList.remove('active');
            };
            bottomNav.addEventListener('click', (e) => { const btn = e.target.closest('.bottom-nav-btn'); if (btn) { openSheet(btn.dataset.sheet); } });
            overlay.addEventListener('click', closeSheets);
            
            const totalBudgetDisplay = document.getElementById('total-budget-display');
            const totalExpenseEl = document.getElementById('total-expense');
            const expenseProgressEl = document.getElementById('expense-progress');
            const expenseListEl = document.getElementById('expense-list');
            let totalBudget = travelData.budgetBreakdown.total.value;
            let expenses = [];
            document.getElementById('edit-budget-btn').addEventListener('click', () => { const newTotal = prompt('새로운 총 예산을 입력하세요:', totalBudget); if (newTotal && !isNaN(newTotal)) { totalBudget = parseInt(newTotal); updateBudget(); } });
            document.getElementById('add-expense-btn').addEventListener('click', () => { const itemEl = document.getElementById('expense-item'); const amountEl = document.getElementById('expense-amount'); if (itemEl.value && amountEl.value > 0) { expenses.push({ id: Date.now(), item: itemEl.value, amount: parseInt(amountEl.value) }); updateBudget(); itemEl.value = ''; amountEl.value = ''; } });
            expenseListEl.addEventListener('click', (e) => { const target = e.target.closest('button'); if (!target) return; const id = parseInt(target.closest('[data-id]').dataset.id); if (target.dataset.action === 'delete') { expenses = expenses.filter(exp => exp.id !== id); } if (target.dataset.action === 'edit') { const expense = expenses.find(exp => exp.id === id); const newItem = prompt('항목 수정:', expense.item); const newAmount = prompt('금액 수정:', expense.amount); if (newItem) expense.item = newItem; if (newAmount && !isNaN(newAmount)) expense.amount = parseInt(newAmount); } updateBudget(); });
            function updateBudget() { const totalSpent = expenses.reduce((sum, exp) => sum + exp.amount, 0); totalBudgetDisplay.textContent = `₩${totalBudget.toLocaleString()}`; totalExpenseEl.textContent = `₩${totalSpent.toLocaleString()}`; const progress = totalBudget > 0 ? Math.min((totalSpent / totalBudget) * 100, 100) : 0; expenseProgressEl.style.width = `${progress}%`; expenseListEl.innerHTML = expenses.map(exp => `<div class="flex justify-between items-center p-3 bg-white rounded-lg border border-slate-100" data-id="${exp.id}"><div><p class="text-sm">${exp.item}</p><p class="font-semibold text-sm text-slate-600">₩${exp.amount.toLocaleString()}</p></div><div class="flex gap-2"><button data-action="edit" class="text-slate-400 hover:text-blue-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path></svg></button><button data-action="delete" class="text-slate-400 hover:text-red-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>`).join(''); }

            const todoListContainer = document.getElementById('todo-list-container');
            let todos = { '필수 항목': [{ text: '여권, 항공권', done: true }, { text: '현지 유심/eSIM', done: false }], '아기용품 (37개월)': [{ text: '기저귀, 물티슈', done: false }, { text: '상비약', done: false }], '전자제품': [{ text: '충전기, 보조배터리', done: false }] };
            document.getElementById('add-todo-btn').addEventListener('click', () => { const newItemEl = document.getElementById('new-todo-item'); if (newItemEl.value) { if (!todos['기타']) todos['기타'] = []; todos['기타'].push({ text: newItemEl.value, done: false }); renderTodos(); newItemEl.value = ''; } });
            todoListContainer.addEventListener('click', (e) => { const target = e.target; if (target.closest('.delete-todo-btn')) { const category = target.closest('.delete-todo-btn').dataset.category; const index = target.closest('.delete-todo-btn').dataset.index; todos[category].splice(index, 1); if(todos[category].length === 0) delete todos[category]; renderTodos(); } if (target.closest('.edit-todo-btn')) { const category = target.closest('.edit-todo-btn').dataset.category; const index = target.closest('.edit-todo-btn').dataset.index; const newText = prompt('항목 수정:', todos[category][index].text); if (newText) { todos[category][index].text = newText; renderTodos(); } } });
            function renderTodos() { todoListContainer.innerHTML = Object.keys(todos).map(category => `<div><h3 class="font-bold text-slate-800 mb-4 border-b pb-2">${category}</h3><div class="space-y-3">${todos[category].map((item, index) => `<div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 shadow-sm"><label class="flex-1 flex items-center gap-3 has-[:checked]:text-slate-400 has-[:checked]:line-through"><input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500" ${item.done ? 'checked' : ''}><span class="text-sm">${item.text}</span></label><button data-category="${category}" data-index="${index}" class="edit-todo-btn text-slate-400 hover:text-blue-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path></svg></button><button data-category="${category}" data-index="${index}" class="delete-todo-btn text-slate-400 hover:text-red-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>`).join('')}</div></div>`).join(''); }
            
            const initializeSliders = () => {
                document.querySelectorAll('.image-slider-container').forEach(sliderContainer => {
                    const imageList = sliderContainer.querySelector('.image-list');
                    const prevBtn = sliderContainer.querySelector('.prev-btn');
                    const nextBtn = sliderContainer.querySelector('.next-btn');
                    const dotsContainer = sliderContainer.querySelector('.slider-dots');
                    const images = imageList.querySelectorAll('div');
                    if (images.length <= 1) {
                        if(dotsContainer) dotsContainer.style.display = 'none';
                        if(prevBtn) prevBtn.style.display = 'none';
                        if(nextBtn) nextBtn.style.display = 'none';
                        return;
                    }
                    let currentIndex = 0;
                    dotsContainer.innerHTML = '';
                    images.forEach((_, i) => { const dot = document.createElement('button'); dot.classList.add('w-2', 'h-2', 'rounded-full', 'transition', 'bg-white/50'); if (i === 0) dot.classList.add('bg-white'); dotsContainer.appendChild(dot); });
                    const dots = dotsContainer.querySelectorAll('button');
                    const updateSlider = (smooth = true) => { imageList.scrollTo({ left: imageList.offsetWidth * currentIndex, behavior: smooth ? 'smooth' : 'auto' }); dots.forEach((dot, i) => dot.classList.toggle('bg-white', i === currentIndex)); };
                    prevBtn.addEventListener('click', () => { currentIndex = (currentIndex > 0) ? currentIndex - 1 : images.length - 1; updateSlider(); });
                    nextBtn.addEventListener('click', () => { currentIndex = (currentIndex < images.length - 1) ? currentIndex + 1 : 0; updateSlider(); });
                    imageList.addEventListener('scroll', () => { const newIndex = Math.round(imageList.scrollLeft / imageList.offsetWidth); if(newIndex !== currentIndex) { currentIndex = newIndex; updateSlider(false); } });
                });
            };
            
            renderApp();
            switchPage(0); 
            renderTodos(); 
            updateBudget();
            initializeSliders();
        });
    </script>
</body>
</html>
