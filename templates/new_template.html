<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ÎßàÏπ¥Ïò§ Í∞ÄÏ°±Ïó¨Ìñâ</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
        }
        .gradient-text {
            background-image: linear-gradient(45deg, #F57C00, #FFB74D);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .page-container {
            display: flex;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .page-content {
            flex-shrink: 0;
            width: 100%;
        }
        .nav-tab.active {
            color: #F57C00;
            font-weight: 700;
            border-color: #F57C00;
        }
        .bottom-sheet {
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .bottom-sheet.active {
            transform: translateY(0);
        }
        .overlay {
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none;
        }
        .overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        .slider-arrow {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .image-slider-container:hover .slider-arrow {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto max-w-lg min-h-screen bg-white shadow-2xl shadow-slate-200 flex flex-col relative overflow-hidden">
        
        <!-- ÏÉÅÎã® Ìó§Îçî (Í≥†Ï†ï) -->
        <header id="main-header" class="sticky top-0 z-20 bg-white/95 backdrop-blur-lg border-b border-slate-100">
            <div class="p-6 flex justify-between items-center">
                <div class="flex-1 min-w-0">
                    <h1 id="main-title" class="text-lg font-bold text-slate-900 truncate"></h1>
                    <p id="main-subtitle" class="text-xs text-slate-500 truncate"></p>
                </div>
                <button class="w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 transition flex items-center justify-center flex-shrink-0 ml-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
                </button>
            </div>
            <!-- Ïä§ÌÅ¨Î°§Ìòï ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
            <div id="top-nav" class="px-4 border-t border-slate-100">
                <div class="flex items-center gap-4 overflow-x-auto no-scrollbar">
                    <!-- Day Tabs will be generated by JS -->
                </div>
            </div>
        </header>

        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ (Ïä§ÏôÄÏù¥ÌîÑ Í∞ÄÎä•) -->
        <main class="flex-1 overflow-hidden">
            <div id="page-container" class="page-container h-full">
                <!-- Day Pages will be generated by JS -->
            </div>
        </main>

        <!-- Îñ†ÏûàÎäî ÌïòÎã® ÌÉ≠ -->
        <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 z-30">
            <div id="bottom-nav" class="flex items-center gap-2 bg-white/70 backdrop-blur-xl p-2 rounded-full shadow-lg ring-1 ring-black/5">
                <button data-sheet="info" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                    <span class="text-xs font-medium">Ï†ïÎ≥¥</span>
                </button>
                <button data-sheet="budget" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                     <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                    <span class="text-xs font-medium">ÏòàÏÇ∞</span>
                </button>
                <button data-sheet="todo" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                    <span class="text-xs font-medium">Ï§ÄÎπÑÎ¨º</span>
                </button>
            </div>
        </nav>

        <!-- Î∞îÌÖÄ ÏãúÌä∏ Ïò§Î≤ÑÎ†àÏù¥ -->
        <div id="overlay" class="overlay fixed inset-0 bg-black/40 z-40"></div>

        <!-- Ï†ïÎ≥¥ Î∞îÌÖÄ ÏãúÌä∏ -->
        <div id="sheet-info" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">Ïó¨Ìñâ Ï†ïÎ≥¥</h2>
                <div class="space-y-4" id="info-cards">
                    <!-- Info Cards will be generated by JS -->
                </div>
            </div>
        </div>
        
        <!-- ÏòàÏÇ∞ Î∞îÌÖÄ ÏãúÌä∏ -->
        <div id="sheet-budget" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">Ïó¨Ìñâ ÏòàÏÇ∞</h2>
                <div class="space-y-6">
                    <div class="bg-slate-100 p-5 rounded-xl">
                        <div class="flex justify-between items-center mb-2">
                            <div>
                                <h3 class="font-bold text-slate-800 flex items-center gap-2">
                                    Ï¥ù ÏòàÏÇ∞
                                    <button id="edit-budget-btn" class="text-slate-400 hover:text-orange-500">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path></svg>
                                    </button>
                                </h3>
                                <p id="total-budget-display" class="text-xs text-slate-500"></p>
                            </div>
                            <span id="total-expense" class="font-bold text-orange-600 text-lg"></span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-2.5">
                            <div id="expense-progress" class="bg-gradient-to-r from-orange-400 to-amber-500 h-2.5 rounded-full transition-all" style="width: 0%"></div>
                        </div>
                    </div>
                    <div id="expense-list" class="space-y-3">
                        <!-- Expense items will be added here -->
                    </div>
                    <div>
                        <h3 class="font-bold text-slate-800 mt-8 mb-4 border-b pb-2">ÏßÄÏ∂ú Ï∂îÍ∞Ä</h3>
                        <div class="space-y-3">
                            <input id="expense-item" type="text" placeholder="Ìï≠Î™© (Ïòà: Ï†ÄÎÖÅ ÏãùÏÇ¨)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <input id="expense-amount" type="number" placeholder="Í∏àÏï° (Ïõê)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <button id="add-expense-btn" class="w-full bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">Ï∂îÍ∞ÄÌïòÍ∏∞</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï§ÄÎπÑÎ¨º Î∞îÌÖÄ ÏãúÌä∏ -->
        <div id="sheet-todo" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">Ïó¨Ìñâ Ï§ÄÎπÑÎ¨º</h2>
                <div id="todo-list-container" class="space-y-6">
                    <!-- Todo categories and items will be generated by JS -->
                </div>
                 <div class="mt-8 flex gap-2">
                    <input id="new-todo-item" type="text" placeholder="ÏÉà Ï§ÄÎπÑÎ¨º Ï∂îÍ∞Ä" class="flex-1 p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                    <button id="add-todo-btn" class="bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">Ï∂îÍ∞Ä</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        const travelData = { "tripMeta": { "destination": "Macau", "duration": "2Î∞ï 3Ïùº", "startDate": "2024-07-30", "endDate": "2024-08-01", "tripType": "family", "planConfidence": 0.85 }, "mainPlan": { "planId": "main", "planName": "ÏïÑÏù¥ÏôÄ Ìï®ÍªòÌïòÎäî Ïó¨Ïú†Î°úÏö¥ ÎßàÏπ¥Ïò§ Í∞ÄÏ°± Ïó¨Ìñâ", "description": "37Í∞úÏõî ÏïÑÏù¥Ïùò Î¶¨Îì¨Ïóê ÎßûÏ∂∞ Í∑∏ÎûúÎìú Î¶¨Ï°∞Ìä∏ Îç±ÏùÑ Ï§ëÏã¨ÏúºÎ°ú ÏÑ§Í≥ÑÎêú Ìé∏ÏïàÌïòÍ≥† Ï¶êÍ±∞Ïö¥ Í∞ÄÏ°± Ïó¨Ìñâ ÏùºÏ†ïÏûÖÎãàÎã§.", "dailyPlans": [ { "day": 1, "date": "2024-07-30", "dayTheme": "ÎèÑÏ∞©Í≥º Í∑∏ÎûúÎìú Î¶¨Ï°∞Ìä∏ Îç±Ïùò Ï¶êÍ±∞ÏõÄ", "activities": [ { "id": "day1-activity1", "time": "14:00", "duration": 90, "type": "transport", "title": "ÎßàÏπ¥Ïò§ ÎèÑÏ∞© Î∞è Í∞§Îü≠Ïãú ÎßàÏπ¥Ïò§ Ï≤¥ÌÅ¨Ïù∏", "description": "ÎßàÏπ¥Ïò§ Íµ≠Ï†úÍ≥µÌï≠(MFM) ÎèÑÏ∞© ÌõÑ, Í∞§Îü≠Ïãú ÎßàÏπ¥Ïò§ Î¨¥Î£å ÏÖîÌãÄÎ≤ÑÏä§Î•º Ïù¥Ïö©ÌïòÏó¨ Ìò∏ÌÖîÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§. Ï≤¥ÌÅ¨Ïù∏ ÌõÑ Ïû†Ïãú Ìú¥ÏãùÏùÑ Ï∑®ÌïòÎ©∞ ÏïÑÏù¥Ïùò Ïª®ÎîîÏÖòÏùÑ Ï°∞Ï†àÌï©ÎãàÎã§.", "tips": [ "Í≥µÌï≠ÏóêÏÑú Ìò∏ÌÖî ÏÖîÌãÄÎ≤ÑÏä§Î•º Ïù¥Ïö©ÌïòÎ©¥ Ìé∏Î¶¨ÌïòÍ≥† Î¨¥Î£åÏûÖÎãàÎã§.", "Ï≤¥ÌÅ¨Ïù∏ Ï†Ñ ÏßêÏùÑ Îß°Í∏∞Í≥† Î¶¨Ï°∞Ìä∏ ÏãúÏÑ§ÏùÑ ÎØ∏Î¶¨ ÎëòÎü¨Î≥º Ïàò ÏûàÏäµÎãàÎã§." ], "placeDetails": { "placeId": "ChIJWcXn5g1wATQRDGP94RbxDu0", "name": "Í∞§Îü≠ÏãúÌò∏ÌÖî", "address": "Galaxy Macau, G/F, ÎßàÏπ¥Ïò§", "rating": 4.5, "photos": [ "https://placehold.co/600x300/667eea/ffffff?text=Galaxy+Hotel+1", "https://placehold.co/600x300/764ba2/ffffff?text=Galaxy+Hotel+2" ], "reviews": "\"ÏµúÍ≥†Ïùò ÏÑúÎπÑÏä§Î•º Ï∂îÍµ¨ÌïòÎäî Ìò∏ÌÖî...\" (5‚≠ê)", "website": "https://www.galaxymacau.com/", "mapLink": "https://maps.google.com/?q=22.1489092,113.5543443" } }, { "id": "day1-activity2", "time": "16:00", "duration": 180, "type": "activity", "title": "Í∑∏ÎûúÎìú Î¶¨Ï°∞Ìä∏ Îç±ÏóêÏÑú Ïã†ÎÇòÎäî Î¨ºÎÜÄÏù¥", "description": "ÏïÑÏù¥ÏôÄ Ìï®Íªò Í∑∏ÎûúÎìú Î¶¨Ï°∞Ìä∏ Îç±Ïùò ÌååÎèÑÌíÄ, Ïú†ÏàòÌíÄ, ÏõåÌÑ∞ Ïä¨ÎùºÏù¥Îìú Îì± Îã§ÏñëÌïú ÏãúÏÑ§ÏùÑ Ï¶êÍ∏∞Î©∞ ÏãúÏõêÌïú ÏãúÍ∞ÑÏùÑ Î≥¥ÎÉÖÎãàÎã§.", "tips": [ "Ïñ¥Î¶∞ ÏïÑÏù¥Î•º ÏúÑÌïú Íµ¨Î™ÖÏ°∞ÎÅºÏôÄ ÌäúÎ∏åÎ•º Ï§ÄÎπÑÌïòÍ±∞ÎÇò ÌòÑÏû•ÏóêÏÑú ÎåÄÏó¨ Í∞ÄÎä•Ìï©ÎãàÎã§." ], "placeDetails": { "name": "Í∑∏ÎûúÎìú Î¶¨Ï°∞Ìä∏ Îç±", "address": "Í∞§Îü≠Ïãú ÎßàÏπ¥Ïò§ ÎÇ¥Î∂Ä", "rating": 4.8, "photos": [ "https://placehold.co/600x300/38bdf8/ffffff?text=Water+Park+1", "https://placehold.co/600x300/06b6d4/ffffff?text=Water+Park+2" ], "reviews": "\"ÏïÑÏù¥ÏôÄ Ìï®ÍªòÎùºÎ©¥ ÏµúÍ≥†Ïùò ÏÑ†ÌÉù! ÌïòÎ£® Ï¢ÖÏùº ÎÜÄÏïÑÎèÑ ÏßÄÎ£®ÌïòÏßÄ ÏïäÏïÑÏöî.\" (5‚≠ê)", "website": "https://www.galaxymacau.com/", "mapLink": "https://maps.google.com/?q=22.1489092,113.5543443" } } ] }, { "day": 2, "date": "2024-07-31", "dayTheme": "ÎßàÏπ¥Ïò§Ïùò Ïó≠ÏÇ¨ÏôÄ ÏïÑÏù¥Îì§ÏùÑ ÏúÑÌïú Ï¶êÍ±∞ÏõÄ", "activities": [ { "id": "day2-activity1", "time": "09:30", "duration": 90, "type": "sightseeing", "title": "ÏÑ∏ÎÇòÎèÑ Í¥ëÏû• & ÏÑ± Î∞îÏö∏ ÏÑ±Îãπ Ïú†Ï†Å", "description": "ÎßàÏπ¥Ïò§Ïùò ÏÉÅÏßïÏ†ÅÏù∏ Ïú†Ï†ÅÏßÄÎ•º Î∞©Î¨∏ÌïòÏó¨ ÏÇ¨ÏßÑÏùÑ Ï∞çÍ≥† Ïó≠ÏÇ¨Ï†ÅÏù∏ Î∂ÑÏúÑÍ∏∞Î•º ÎäêÍª¥Î¥ÖÎãàÎã§.", "tips": [ "Ïò§Ï†Ñ ÏùºÏ∞ç Î∞©Î¨∏ÌïòÏó¨ Ïù∏ÌååÎ•º ÌîºÌïòÎäî Í≤ÉÏù¥ Ï¢ãÏäµÎãàÎã§." ], "placeDetails": { "name": "ÏÑ∏ÎÇòÎèÑ Í¥ëÏû•", "address": "Senado Square, ÎßàÏπ¥Ïò§", "rating": 4.3, "photos": [ "https://placehold.co/600x300/34d399/ffffff?text=Senado+Square" ], "reviews": "\"ÌôçÏΩ©&ÎßàÏπ¥Ïò§ÏóêÏÑú Í∞ÄÏû• Ïú†ÎüΩ Î∂ÑÏúÑÍ∏∞ ÎÇòÎäî Ïû•ÏÜåÏòÄÏñ¥Ïöî!\" (4‚≠ê)", "website": "http://www.culturalheritage.mo/", "mapLink": "https://maps.google.com/?q=22.1935334,113.5397593" } } ] }, { "day": 3, "date": "2024-08-01", "dayTheme": "ÎßàÏßÄÎßâ Ï¶êÍ±∞ÏõÄÍ≥º ÏïÑÏâ¨Ïö¥ ÏûëÎ≥Ñ", "activities": [ { "id": "day3-activity1", "time": "09:30", "duration": 120, "type": "activity", "title": "Ìò∏ÌÖî ÏãúÏÑ§ Ïû¨Î∞©Î¨∏ ÎòêÎäî ÏáºÌïë", "description": "Ï∂úÍµ≠ Ï†Ñ ÎßàÏßÄÎßâÏúºÎ°ú Í∑∏ÎûúÎìú Î¶¨Ï°∞Ìä∏ Îç±ÏóêÏÑú Î¨ºÎÜÄÏù¥Î•º Ï¶êÍ∏∞Í±∞ÎÇò, ÏáºÌïë ÏïÑÏºÄÏù¥ÎìúÏóêÏÑú Í∏∞ÎÖêÌíàÏùÑ Íµ¨ÏûÖÌï©ÎãàÎã§.", "tips": [ "Ï≤¥ÌÅ¨ÏïÑÏõÉ ÌõÑ ÏßêÏùÑ Îß°Í∏∞Í≥† ÏãúÏÑ§ÏùÑ Ïù¥Ïö©Ìï† Ïàò ÏûàÎäîÏßÄ Ìò∏ÌÖîÏóê Î¨∏ÏùòÌïòÏÑ∏Ïöî." ] } ] } ] }, "alternativePlans": { "weather": { "planId": "weather", "planName": "ÎπÑ Ïò§Îäî ÎÇ†/ÎçîÏö¥ ÎÇ† ÌîåÎûú", "modifiedActivities": [ { "originalId": "day2-activity1", "newActivity": { "title": "ÎßàÏπ¥Ïò§ Í≥ºÌïôÍ¥Ä Î∞©Î¨∏", "type": "sightseeing", "description": "ÏïÑÏù¥Îì§Ïù¥ Ìù•ÎØ∏Î•º ÎäêÎÇÑ ÎßåÌïú Îã§ÏñëÌïú Í≥ºÌïô Ï≤¥Ìóò ÏãúÏÑ§Ïù¥ ÏûàÎäî Ïã§ÎÇ¥ Î∞ïÎ¨ºÍ¥ÄÏûÖÎãàÎã§." } } ] } }, "budgetBreakdown": { "total": { "value": 1500000, "currency": "KRW", "unit": "family" } }, "essentialInfo": { "weather": "7Ïõî Îßê ~ 8Ïõî Ï¥à ÎßàÏπ¥Ïò§Îäî Îß§Ïö∞ Îç•Í≥† ÏäµÌï©ÎãàÎã§.", "transportation": "Ï£ºÏöî Ìò∏ÌÖîÎì§ÏùÄ Î¨¥Î£å ÏÖîÌãÄÎ≤ÑÏä§Î•º Ïö¥ÌñâÌï©ÎãàÎã§.", "mustTryFood": [ "ÏóêÍ∑∏ÌÉÄÎ•¥Ìä∏", "Ìè¨Î•¥Ìà¨Í∞àÏãù ÏπòÌÇ®", "ÎèºÏßÄÍ≥†Í∏∞ Ïª§ÌãÄÎ¶ø Î≤ÑÍ±∞" ], "localTips": [ "Ïã§ÎÇ¥ Ïò®ÎèÑÍ∞Ä ÎÇÆÏúºÎãà ÏñáÏùÄ Í≤âÏò∑ÏùÑ Íº≠ Ï±ôÍ∏∞ÏÑ∏Ïöî." ] } };

        document.addEventListener('DOMContentLoaded', () => {
            const navContainer = document.querySelector('#top-nav .flex');
            const pageContainer = document.getElementById('page-container');
            const bottomNav = document.getElementById('bottom-nav');
            const overlay = document.getElementById('overlay');
            const bottomSheets = { info: document.getElementById('sheet-info'), budget: document.getElementById('sheet-budget'), todo: document.getElementById('sheet-todo'), };
            let currentPageIndex = 0;
            
            const activityIcons = {
                transport: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-2.2-1.8-4-4-4H6c-2.2 0-4 1.8-4 4v3c0 .6.4 1 1 1h2"></path><circle cx="9" cy="17" r="2"></circle><circle cx="15" cy="17" r="2"></circle></svg>`, color: 'bg-blue-500' },
                hotel: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>`, color: 'bg-teal-500' },
                meal: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M17 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M3 13v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-8"></path></svg>`, color: 'bg-amber-500' },
                activity: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72z"></path><path d="m14 7 3 3"></path></svg>`, color: 'bg-rose-500' },
                sightseeing: { icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>`, color: 'bg-purple-500' },
            };

            function renderApp() {
                document.getElementById('main-title').textContent = `üá≤üá¥ ${travelData.tripMeta.destination} Í∞ÄÏ°±Ïó¨Ìñâ`;
                document.getElementById('main-subtitle').textContent = travelData.mainPlan.description;
                
                pageContainer.innerHTML = '';
                navContainer.innerHTML = '';
                travelData.mainPlan.dailyPlans.forEach((dayPlan, index) => {
                    let activitiesHtml = dayPlan.activities.map(act => {
                        const iconInfo = activityIcons[act.type] || { icon: '', color: 'bg-slate-500' };
                        const imagesHtml = act.placeDetails && act.placeDetails.photos ? `
                            <div class="relative -mx-5 mb-4 rounded-lg overflow-hidden image-slider-container">
                                <div class="flex overflow-x-auto snap-x snap-mandatory no-scrollbar image-list">
                                    ${act.placeDetails.photos.map(src => `<div class="snap-center flex-shrink-0 w-full"><img src="${src}" class="w-full h-auto" alt="${act.title}"></div>`).join('')}
                                </div>
                                <div class="absolute bottom-3 left-0 right-0 flex justify-center gap-2 slider-dots"></div>
                                <button class="slider-arrow absolute top-1/2 left-2 -translate-y-1/2 bg-black/30 text-white w-8 h-8 rounded-full flex items-center justify-center prev-btn">&lt;</button>
                                <button class="slider-arrow absolute top-1/2 right-2 -translate-y-1/2 bg-black/30 text-white w-8 h-8 rounded-full flex items-center justify-center next-btn">&gt;</button>
                            </div>` : '';
                        
                        const detailsHtml = act.placeDetails ? `
                            <div class="space-y-3 pt-2">
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-amber-500">${act.placeDetails.rating}</span>
                                    <div class="flex text-amber-400">${'‚òÖ'.repeat(Math.round(act.placeDetails.rating || 0))}${'‚òÜ'.repeat(5 - Math.round(act.placeDetails.rating || 0))}</div>
                                </div>
                                <div class="flex items-start gap-2 text-sm text-slate-600">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0 mt-0.5"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                                    <span>${act.placeDetails.address}</span>
                                </div>
                                <div class="border-t border-slate-100 pt-3">
                                    <p class="text-xs text-slate-500 mb-1">"${act.placeDetails.reviews.split('|')[0]}"</p>
                                </div>
                                <div class="mt-4 flex gap-3">
                                    <a href="${act.placeDetails.mapLink}" target="_blank" class="flex-1 text-center bg-orange-50 text-orange-700 text-sm font-bold py-2 px-4 rounded-lg hover:bg-orange-100 transition">ÏßÄÎèÑ Î≥¥Í∏∞</a>
                                    <a href="${act.placeDetails.website}" target="_blank" class="flex-1 text-center bg-slate-100 text-slate-700 text-sm font-bold py-2 px-4 rounded-lg hover:bg-slate-200 transition">ÏõπÏÇ¨Ïù¥Ìä∏</a>
                                </div>
                            </div>
                        ` : `<p class="text-sm text-slate-600 leading-relaxed">${act.description}</p>`;
                        
                        const tipsHtml = act.tips && act.tips.length > 0 ? `<div class="mt-4 border-t border-slate-100 pt-3"><h4 class="text-xs font-bold text-slate-500 mb-2">üí° Ï†ÑÎ¨∏Í∞Ä ÌåÅ</h4><ul class="list-disc list-inside text-xs text-slate-500 space-y-1">${act.tips.map(tip => `<li>${tip}</li>`).join('')}</ul></div>` : '';

                        return `<div class="relative pl-12"><div class="absolute left-0 top-1.5 flex items-center"><div class="w-8 h-8 ${iconInfo.color} rounded-full flex items-center justify-center ring-4 ring-white">${iconInfo.icon}</div></div><div class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm"><p class="text-sm font-semibold text-gray-500 mb-1">${act.time} (${act.duration}Î∂Ñ)</p><h3 class="text-lg font-bold mb-3">${act.title}</h3>${imagesHtml}${detailsHtml}${tipsHtml}</div></div>`;
                    }).join('');
                    
                    const pageDiv = document.createElement('div');
                    pageDiv.className = 'page-content h-full overflow-y-auto p-6';
                    pageDiv.innerHTML = `<div class="mb-8"><h2 class="text-3xl font-extrabold gradient-text">DAY ${dayPlan.day}</h2><p class="text-slate-500 font-medium">${dayPlan.dayTheme}</p></div><div class="relative"><div class="absolute left-4 top-2 bottom-2 w-0.5 bg-slate-200"></div><div class="space-y-8">${activitiesHtml}</div></div>`;
                    pageContainer.appendChild(pageDiv);

                    const navTab = document.createElement('button');
                    navTab.className = 'nav-tab py-4 px-2 text-sm font-medium text-slate-500 border-b-2 border-transparent whitespace-nowrap';
                    navTab.textContent = `DAY ${dayPlan.day}`;
                    navTab.dataset.index = index;
                    navContainer.appendChild(navTab);
                });
                
                const infoCardsContainer = document.getElementById('info-cards');
                const infoCards = [
                    { title: 'Ìï≠Í≥µÌé∏', icon: '‚úàÔ∏è', content: 'Ïù∏Ï≤ú(ICN) ‚Üî ÎßàÏπ¥Ïò§(MFM)', bg: 'bg-blue-50' },
                    { title: 'ÏàôÏÜå', icon: 'üè®', content: 'ÏïàÎã§Ï¶à ÎßàÏπ¥Ïò§ (Andaz Macau)', bg: 'bg-green-50' },
                    { title: 'Ïó¨Ìñâ ÌåÅ', icon: 'üí°', content: travelData.essentialInfo.localTips.join('<br>'), bg: 'bg-yellow-50' },
                    { title: 'Ï£ºÏùòÏ†ê', icon: '‚ö†Ô∏è', content: travelData.essentialInfo.weather, bg: 'bg-red-50' },
                    { title: 'üåç ÌòÑÏßÄ Î¨∏Ìôî ÌåÅ', icon: 'üåç', content: `<b>Íº≠ Î®πÏñ¥Î¥êÏïº Ìï† ÏùåÏãù:</b><br>${travelData.essentialInfo.mustTryFood.join(', ')}`, bg: 'bg-purple-50' }
                ];
                infoCardsContainer.innerHTML = infoCards.map(card => `<div class="p-5 ${card.bg} rounded-xl"><h3 class="font-bold text-slate-800 mb-3 text-lg">${card.icon} ${card.title}</h3><p class="text-sm text-slate-600 leading-relaxed">${card.content}</p></div>`).join('');
            }

            const navTabs = document.querySelectorAll('.nav-tab');
            const switchPage = (index) => {
                currentPageIndex = index;
                pageContainer.style.transform = `translateX(-${index * 100}%)`;
                navTabs.forEach((tab, i) => tab.classList.toggle('active', i === index));
                const activeTab = navTabs[index];
                activeTab.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                initializeSliders();
            };
            navContainer.addEventListener('click', (e) => { if (e.target.classList.contains('nav-tab')) { switchPage(parseInt(e.target.dataset.index)); } });
            
            let touchStartX = 0;
            pageContainer.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; });
            pageContainer.addEventListener('touchend', (e) => {
                const touchEndX = e.changedTouches[0].screenX;
                if (touchEndX < touchStartX - 50 && currentPageIndex < navTabs.length - 1) { switchPage(currentPageIndex + 1); }
                if (touchEndX > touchStartX + 50 && currentPageIndex > 0) { switchPage(currentPageIndex - 1); }
            });

            const openSheet = (sheetId) => {
                Object.values(bottomSheets).forEach(sheet => sheet.classList.remove('active'));
                if (bottomSheets[sheetId]) { bottomSheets[sheetId].classList.add('active'); overlay.classList.add('active'); }
            };
            const closeSheets = () => {
                Object.values(bottomSheets).forEach(sheet => sheet.classList.remove('active'));
                overlay.classList.remove('active');
            };
            bottomNav.addEventListener('click', (e) => { const btn = e.target.closest('.bottom-nav-btn'); if (btn) { openSheet(btn.dataset.sheet); } });
            overlay.addEventListener('click', closeSheets);
            
            const totalBudgetDisplay = document.getElementById('total-budget-display');
            const totalExpenseEl = document.getElementById('total-expense');
            const expenseProgressEl = document.getElementById('expense-progress');
            const expenseListEl = document.getElementById('expense-list');
            let totalBudget = travelData.budgetBreakdown.total.value;
            let expenses = [];
            document.getElementById('edit-budget-btn').addEventListener('click', () => { const newTotal = prompt('ÏÉàÎ°úÏö¥ Ï¥ù ÏòàÏÇ∞ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:', totalBudget); if (newTotal && !isNaN(newTotal)) { totalBudget = parseInt(newTotal); updateBudget(); } });
            document.getElementById('add-expense-btn').addEventListener('click', () => { const itemEl = document.getElementById('expense-item'); const amountEl = document.getElementById('expense-amount'); if (itemEl.value && amountEl.value > 0) { expenses.push({ id: Date.now(), item: itemEl.value, amount: parseInt(amountEl.value) }); updateBudget(); itemEl.value = ''; amountEl.value = ''; } });
            expenseListEl.addEventListener('click', (e) => { const target = e.target.closest('button'); if (!target) return; const id = parseInt(target.closest('[data-id]').dataset.id); if (target.dataset.action === 'delete') { expenses = expenses.filter(exp => exp.id !== id); } if (target.dataset.action === 'edit') { const expense = expenses.find(exp => exp.id === id); const newItem = prompt('Ìï≠Î™© ÏàòÏ†ï:', expense.item); const newAmount = prompt('Í∏àÏï° ÏàòÏ†ï:', expense.amount); if (newItem) expense.item = newItem; if (newAmount && !isNaN(newAmount)) expense.amount = parseInt(newAmount); } updateBudget(); });
            function updateBudget() { const totalSpent = expenses.reduce((sum, exp) => sum + exp.amount, 0); totalBudgetDisplay.textContent = `‚Ç©${totalBudget.toLocaleString()}`; totalExpenseEl.textContent = `‚Ç©${totalSpent.toLocaleString()}`; const progress = totalBudget > 0 ? Math.min((totalSpent / totalBudget) * 100, 100) : 0; expenseProgressEl.style.width = `${progress}%`; expenseListEl.innerHTML = expenses.map(exp => `<div class="flex justify-between items-center p-3 bg-white rounded-lg border border-slate-100" data-id="${exp.id}"><div><p class="text-sm">${exp.item}</p><p class="font-semibold text-sm text-slate-600">‚Ç©${exp.amount.toLocaleString()}</p></div><div class="flex gap-2"><button data-action="edit" class="text-slate-400 hover:text-blue-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path></svg></button><button data-action="delete" class="text-slate-400 hover:text-red-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>`).join(''); }

            const todoListContainer = document.getElementById('todo-list-container');
            let todos = { 'ÌïÑÏàò Ìï≠Î™©': [{ text: 'Ïó¨Í∂å, Ìï≠Í≥µÍ∂å', done: true }, { text: 'ÌòÑÏßÄ Ïú†Ïã¨/eSIM', done: false }], 'ÏïÑÍ∏∞Ïö©Ìíà (37Í∞úÏõî)': [{ text: 'Í∏∞Ï†ÄÍ∑Ä, Î¨ºÌã∞Ïäà', done: false }, { text: 'ÏÉÅÎπÑÏïΩ', done: false }], 'Ï†ÑÏûêÏ†úÌíà': [{ text: 'Ï∂©Ï†ÑÍ∏∞, Î≥¥Ï°∞Î∞∞ÌÑ∞Î¶¨', done: false }] };
            document.getElementById('add-todo-btn').addEventListener('click', () => { const newItemEl = document.getElementById('new-todo-item'); if (newItemEl.value) { if (!todos['Í∏∞ÌÉÄ']) todos['Í∏∞ÌÉÄ'] = []; todos['Í∏∞ÌÉÄ'].push({ text: newItemEl.value, done: false }); renderTodos(); newItemEl.value = ''; } });
            todoListContainer.addEventListener('click', (e) => { const target = e.target; if (target.closest('.delete-todo-btn')) { const category = target.closest('.delete-todo-btn').dataset.category; const index = target.closest('.delete-todo-btn').dataset.index; todos[category].splice(index, 1); if(todos[category].length === 0) delete todos[category]; renderTodos(); } if (target.closest('.edit-todo-btn')) { const category = target.closest('.edit-todo-btn').dataset.category; const index = target.closest('.edit-todo-btn').dataset.index; const newText = prompt('Ìï≠Î™© ÏàòÏ†ï:', todos[category][index].text); if (newText) { todos[category][index].text = newText; renderTodos(); } } });
            function renderTodos() { todoListContainer.innerHTML = Object.keys(todos).map(category => `<div><h3 class="font-bold text-slate-800 mb-4 border-b pb-2">${category}</h3><div class="space-y-3">${todos[category].map((item, index) => `<div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-slate-200 shadow-sm"><label class="flex-1 flex items-center gap-3 has-[:checked]:text-slate-400 has-[:checked]:line-through"><input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500" ${item.done ? 'checked' : ''}><span class="text-sm">${item.text}</span></label><button data-category="${category}" data-index="${index}" class="edit-todo-btn text-slate-400 hover:text-blue-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path></svg></button><button data-category="${category}" data-index="${index}" class="delete-todo-btn text-slate-400 hover:text-red-500"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div>`).join('')}</div></div>`).join(''); }
            
            const initializeSliders = () => {
                document.querySelectorAll('.image-slider-container').forEach(sliderContainer => {
                    const imageList = sliderContainer.querySelector('.image-list');
                    const prevBtn = sliderContainer.querySelector('.prev-btn');
                    const nextBtn = sliderContainer.querySelector('.next-btn');
                    const dotsContainer = sliderContainer.querySelector('.slider-dots');
                    const images = imageList.querySelectorAll('div');
                    if (images.length <= 1) {
                        if(dotsContainer) dotsContainer.style.display = 'none';
                        if(prevBtn) prevBtn.style.display = 'none';
                        if(nextBtn) nextBtn.style.display = 'none';
                        return;
                    }
                    let currentIndex = 0;
                    dotsContainer.innerHTML = '';
                    images.forEach((_, i) => { const dot = document.createElement('button'); dot.classList.add('w-2', 'h-2', 'rounded-full', 'transition', 'bg-white/50'); if (i === 0) dot.classList.add('bg-white'); dotsContainer.appendChild(dot); });
                    const dots = dotsContainer.querySelectorAll('button');
                    const updateSlider = (smooth = true) => { imageList.scrollTo({ left: imageList.offsetWidth * currentIndex, behavior: smooth ? 'smooth' : 'auto' }); dots.forEach((dot, i) => dot.classList.toggle('bg-white', i === currentIndex)); };
                    prevBtn.addEventListener('click', () => { currentIndex = (currentIndex > 0) ? currentIndex - 1 : images.length - 1; updateSlider(); });
                    nextBtn.addEventListener('click', () => { currentIndex = (currentIndex < images.length - 1) ? currentIndex + 1 : 0; updateSlider(); });
                    imageList.addEventListener('scroll', () => { const newIndex = Math.round(imageList.scrollLeft / imageList.offsetWidth); if(newIndex !== currentIndex) { currentIndex = newIndex; updateSlider(false); } });
                });
            };
            
            renderApp();
            switchPage(0); 
            renderTodos(); 
            updateBudget();
            initializeSliders();
        });
    </script>
</body>
</html>
