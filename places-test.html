<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Places API í…ŒìŠ¤íŠ¸ - ë§ˆì¹´ì˜¤ ì—¬í–‰ PWA</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #4F46E5;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
            border-left: 4px solid #4F46E5;
        }
        
        .test-button {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background 0.2s;
        }
        
        .test-button:hover {
            background: #4338CA;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .loading {
            color: #4F46E5;
            font-style: italic;
        }
        
        .success {
            color: #059669;
            font-weight: bold;
        }
        
        .error {
            color: #dc2626;
            font-weight: bold;
        }
        
        .place-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-left: 4px solid #10b981;
        }
        
        .place-name {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 8px;
        }
        
        .place-address {
            color: #6b7280;
            margin-bottom: 8px;
        }
        
        .place-rating {
            color: #f59e0b;
            margin-bottom: 8px;
        }
        
        .place-link {
            display: inline-block;
            background: #4F46E5;
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            margin-top: 10px;
        }
        
        .place-link:hover {
            background: #4338CA;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ºï¸ Google Places API í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h3>ğŸ“ ë‹¨ì¼ ì¥ì†Œ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testSinglePlace('ë§ˆì¹´ì˜¤êµ­ì œê³µí•­')">ë§ˆì¹´ì˜¤êµ­ì œê³µí•­</button>
            <button class="test-button" onclick="testSinglePlace('ê°¤ëŸ­ì‹œ ë§ˆì¹´ì˜¤')">ê°¤ëŸ­ì‹œ ë§ˆì¹´ì˜¤</button>
            <button class="test-button" onclick="testSinglePlace('ì„¸ë‚˜ë„ ê´‘ì¥')">ì„¸ë‚˜ë„ ê´‘ì¥</button>
            <button class="test-button" onclick="testSinglePlace('ì„± ë°”ìš¸ ì„±ë‹¹ ìœ ì ')">ì„± ë°”ìš¸ ì„±ë‹¹ ìœ ì </button>
            <div id="single-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ”„ ì „ì²´ ì¥ì†Œ ë°ì´í„° ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testAllPlaces()">ëª¨ë“  ì£¼ìš” ì¥ì†Œ ê²€ìƒ‰</button>
            <div id="all-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ”— ê°œì„ ëœ ë§µ ë§í¬ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testMapLinks()">ë§µ ë§í¬ ìë™ ê°œì„ </button>
            <div id="links-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>âœ… ì‹¤ì œ ì¥ì†Œ ì¹´ë“œ ë Œë”ë§</h3>
            <div id="place-cards"></div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="./config.js"></script>
    <script src="./places-api.js"></script>
    
    <script>
        // ë‹¨ì¼ ì¥ì†Œ í…ŒìŠ¤íŠ¸
        async function testSinglePlace(placeName) {
            const resultDiv = document.getElementById('single-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `<span class="loading">ğŸ” "${placeName}" ê²€ìƒ‰ ì¤‘...</span>`;
            
            try {
                if (!placesService) {
                    throw new Error('Places Serviceê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                const result = await placesService.findPlaceByName(placeName);
                
                resultDiv.innerHTML = `<span class="success">âœ… ê²€ìƒ‰ ì™„ë£Œ!</span>\n\n` + 
                    JSON.stringify(result, null, 2);
                
                // ì¥ì†Œ ì¹´ë“œë¡œ ë Œë”ë§
                renderPlaceCard(result);
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ì˜¤ë¥˜ ë°œìƒ:</span>\n${error.message}`;
            }
        }

        // ì „ì²´ ì¥ì†Œ í…ŒìŠ¤íŠ¸
        async function testAllPlaces() {
            const resultDiv = document.getElementById('all-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `<span class="loading">ğŸ”„ ëª¨ë“  ì£¼ìš” ì¥ì†Œ ê²€ìƒ‰ ì¤‘... (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)</span>`;
            
            try {
                if (!placesService) {
                    throw new Error('Places Serviceê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                }
                
                const results = await placesService.updateAllPlaces();
                
                resultDiv.innerHTML = `<span class="success">âœ… ì „ì²´ ì—…ë°ì´íŠ¸ ì™„ë£Œ!</span>\n\n` + 
                    JSON.stringify(results, null, 2);
                
                // ëª¨ë“  ì¥ì†Œ ì¹´ë“œ ë Œë”ë§
                Object.values(results).forEach(place => {
                    renderPlaceCard(place);
                });
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ì˜¤ë¥˜ ë°œìƒ:</span>\n${error.message}`;
            }
        }

        // ë§µ ë§í¬ ê°œì„  í…ŒìŠ¤íŠ¸
        function testMapLinks() {
            const resultDiv = document.getElementById('links-result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `<span class="loading">ğŸ”— ë§µ ë§í¬ ê°œì„  ì¤‘...</span>`;
            
            try {
                // ê°€ìƒì˜ ë§µ ë§í¬ë“¤ ìƒì„±
                const testLinks = [
                    { name: 'ë§ˆì¹´ì˜¤êµ­ì œê³µí•­', coords: { lat: 22.1496, lng: 113.5913 } },
                    { name: 'ê°¤ëŸ­ì‹œ ë§ˆì¹´ì˜¤', coords: { lat: 22.1489, lng: 113.5543 } },
                    { name: 'ì„¸ë‚˜ë„ ê´‘ì¥', coords: { lat: 22.1935, lng: 113.5398 } }
                ];
                
                let improvedLinks = '';
                testLinks.forEach(link => {
                    const improvedUrl = `https://maps.google.com/maps/search/${encodeURIComponent(link.name)}/@${link.coords.lat},${link.coords.lng},15z`;
                    improvedLinks += `${link.name}: ${improvedUrl}\n\n`;
                });
                
                resultDiv.innerHTML = `<span class="success">âœ… ë§µ ë§í¬ ê°œì„  ì™„ë£Œ!</span>\n\n${improvedLinks}`;
                
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">âŒ ì˜¤ë¥˜ ë°œìƒ:</span>\n${error.message}`;
            }
        }

        // ì¥ì†Œ ì¹´ë“œ ë Œë”ë§
        function renderPlaceCard(place) {
            const cardsContainer = document.getElementById('place-cards');
            
            const card = document.createElement('div');
            card.className = 'place-card';
            
            card.innerHTML = `
                <div class="place-name">${place.name}</div>
                <div class="place-address">ğŸ“ ${place.address}</div>
                <div class="place-rating">â­ ${place.rating > 0 ? `${place.rating}/5.0` : 'í‰ì  ì—†ìŒ'} 
                    ${place.userRatingsTotal > 0 ? `(${place.userRatingsTotal}ê°œ ë¦¬ë·°)` : ''}</div>
                ${place.website ? `<div>ğŸŒ <a href="${place.website}" target="_blank">ê³µì‹ ì›¹ì‚¬ì´íŠ¸</a></div>` : ''}
                ${place.phoneNumber ? `<div>ğŸ“ ${place.phoneNumber}</div>` : ''}
                <a href="${place.mapLink}" target="_blank" class="place-link">êµ¬ê¸€ë§µì—ì„œ ë³´ê¸°</a>
                ${place.fallback ? '<div style="color: #dc2626; font-size: 12px; margin-top: 8px;">âš ï¸ API ì‘ë‹µ ì—†ìŒ - ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©</div>' : ''}
            `;
            
            cardsContainer.appendChild(card);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ API í‚¤ í™•ì¸
        document.addEventListener('DOMContentLoaded', () => {
            const status = document.createElement('div');
            status.style.cssText = 'text-align: center; margin-bottom: 20px; padding: 10px; border-radius: 8px;';
            
            if (typeof CONFIG !== 'undefined' && CONFIG.GOOGLE_PLACES_API_KEY && CONFIG.GOOGLE_PLACES_API_KEY !== 'AIzaSyDERW_lRSOP3dcot_xSIgiTWhHRX4U1RXU') {
                status.innerHTML = 'âœ… Google Places API ì„¤ì • í™•ì¸ë¨';
                status.style.background = '#ecfdf5';
                status.style.color = '#059669';
            } else {
                status.innerHTML = 'âš ï¸ Google Places API í‚¤ë¥¼ config.jsì— ì„¤ì •í•´ì£¼ì„¸ìš”';
                status.style.background = '#fef2f2';
                status.style.color = '#dc2626';
            }
            
            document.querySelector('.container').insertBefore(status, document.querySelector('h1').nextSibling);
        });
    </script>
</body>
</html>