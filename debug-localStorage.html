<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>localStorage ë””ë²„ê·¸</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 10px; margin: 10px 0; }
        .success { background: #e8f5e8; color: #2e7d2e; }
        .error { background: #ffe8e8; color: #d32f2f; }
        .info { background: #e3f2fd; color: #1976d2; }
        pre { background: #f8f8f8; padding: 10px; border-radius: 5px; overflow-x: auto; }
        button { background: #4caf50; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin: 5px; cursor: pointer; }
        button:hover { background: #45a049; }
        .clear { background: #f44336; }
        .clear:hover { background: #d32f2f; }
    </style>
</head>
<body>
    <h1>ğŸ” localStorage ë””ë²„ê·¸ ë„êµ¬</h1>
    
    <div class="container">
        <h3>ğŸ“‹ í˜„ì¬ ì‘ì—…</h3>
        <button onclick="loadTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±</button>
        <button onclick="checkStorage()">localStorage í™•ì¸</button>
        <button onclick="clearStorage()" class="clear">localStorage ì§€ìš°ê¸°</button>
        <button onclick="testPWAScript()">PWA ìŠ¤í¬ë¦½íŠ¸ í…ŒìŠ¤íŠ¸</button>
    </div>

    <div id="results"></div>

    <script>
        const testTravelData = {
            tripTitle: "ğŸ‡²ğŸ‡´ ë§ˆì¹´ì˜¤ ê°€ì¡±ì—¬í–‰",
            destination: "ë§ˆì¹´ì˜¤",
            duration: "2ë°• 3ì¼",
            budget: "1ì¸ë‹¹ ì•½ 50ë§Œì›",
            destinationEmoji: "ğŸ‡²ğŸ‡´",
            destinationFlag: "ğŸ‡²ğŸ‡´",
            tips: [
                "ğŸ° ì¹´ì§€ë…¸ëŠ” 21ì„¸ ì´ìƒë§Œ ì…ì¥ ê°€ëŠ¥í•´ìš”",
                "ğŸœ í¬ë¥´íˆ¬ê°ˆ ìš”ë¦¬ì™€ ì¤‘êµ­ ìš”ë¦¬ê°€ ì˜ ì–´ìš°ëŸ¬ì§„ ë§ˆì¹´ì˜¤ ìŒì‹ì„ ê¼­ ë“œì„¸ìš”"
            ],
            days: [
                {
                    dayNumber: "1",
                    theme: "ë„ì°© & ì„¸ë‚˜ë„ ê´‘ì¥ íƒë°©",
                    timeline: [
                        { time: "09:00", title: "ì¸ì²œê³µí•­ ì¶œë°œ", description: "ëŒ€í•œí•­ê³µ KE693í¸ìœ¼ë¡œ ë§ˆì¹´ì˜¤ í–¥ë°œ" },
                        { time: "12:30", title: "ë§ˆì¹´ì˜¤ ë„ì°©", description: "ë§ˆì¹´ì˜¤êµ­ì œê³µí•­ ë„ì°© í›„ ì…êµ­ ìˆ˜ì†" }
                    ]
                },
                {
                    dayNumber: "2", 
                    theme: "ë¬¸í™”ìœ ì‚° & ê´€ê´‘ì§€ íˆ¬ì–´",
                    timeline: [
                        { time: "09:00", title: "í˜¸í…” ì¡°ì‹", description: "íŒŒë¦¬ì§€ì•™ ë§ˆì¹´ì˜¤ í˜¸í…” ë·”í˜ ì¡°ì‹" }
                    ]
                }
            ],
            budget_breakdown: [
                { icon: "âœˆï¸", category: "í•­ê³µë£Œ", amount: "20ë§Œì›" },
                { icon: "ğŸ¨", category: "ìˆ™ë°•ë¹„", amount: "15ë§Œì›" }
            ]
        };

        function addResult(type, title, content) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `container ${type}`;
            div.innerHTML = `<h3>${title}</h3><pre>${content}</pre>`;
            results.appendChild(div);
        }

        function loadTestData() {
            try {
                const key = 'generatedApp_test123';
                localStorage.setItem(key, JSON.stringify(testTravelData));
                addResult('success', 'âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ì €ì¥ ì™„ë£Œ', `í‚¤: ${key}\ní¬ê¸°: ${JSON.stringify(testTravelData).length} ë¬¸ì`);
                console.log('âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ì €ì¥:', testTravelData);
            } catch (error) {
                addResult('error', 'âŒ ì €ì¥ ì‹¤íŒ¨', error.message);
            }
        }

        function checkStorage() {
            try {
                const keys = Object.keys(localStorage);
                let report = `ì´ ${keys.length}ê°œì˜ í‚¤ ë°œê²¬:\n\n`;
                
                keys.forEach(key => {
                    const value = localStorage.getItem(key);
                    const size = value ? value.length : 0;
                    report += `${key}: ${size} ë¬¸ì\n`;
                    
                    if (key.startsWith('generatedApp_')) {
                        try {
                            const data = JSON.parse(value);
                            report += `  â†³ ì—¬í–‰ ì œëª©: ${data.tripTitle || 'N/A'}\n`;
                            report += `  â†³ ëª©ì ì§€: ${data.destination || 'N/A'}\n`;
                            report += `  â†³ ì¼ì • ìˆ˜: ${data.days?.length || 0}\n\n`;
                        } catch (e) {
                            report += `  â†³ JSON íŒŒì‹± ì‹¤íŒ¨: ${e.message}\n\n`;
                        }
                    }
                });

                addResult('info', 'ğŸ“¦ localStorage ìƒíƒœ', report);
            } catch (error) {
                addResult('error', 'âŒ í™•ì¸ ì‹¤íŒ¨', error.message);
            }
        }

        function clearStorage() {
            if (confirm('localStorageë¥¼ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.clear();
                addResult('info', 'ğŸ—‘ï¸ localStorage ì§€ìš°ê¸° ì™„ë£Œ', 'ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        function testPWAScript() {
            // PWA ìŠ¤í¬ë¦½íŠ¸ì˜ ë¡œì§ì„ ì‹œë®¬ë ˆì´ì…˜
            const sessionId = 'test123';
            const storageKey = `generatedApp_${sessionId}`;
            
            let report = `ì„¸ì…˜ ID: ${sessionId}\n`;
            report += `ìŠ¤í† ë¦¬ì§€ í‚¤: ${storageKey}\n\n`;

            try {
                const data = localStorage.getItem(storageKey);
                report += `ì›ë³¸ ë°ì´í„° ì¡´ì¬: ${!!data}\n`;
                
                if (data) {
                    const parsed = JSON.parse(data);
                    report += `JSON íŒŒì‹± ì„±ê³µ: âœ…\n`;
                    report += `ì—¬í–‰ ì œëª©: ${parsed.tripTitle}\n`;
                    report += `ëª©ì ì§€: ${parsed.destination}\n`;
                    report += `ê¸°ê°„: ${parsed.duration}\n`;
                    report += `ì¼ì • ìˆ˜: ${parsed.days?.length || 0}\n`;
                } else {
                    report += `ë°ì´í„° ì—†ìŒ: âŒ\n`;
                    report += `ì‚¬ìš© ê°€ëŠ¥í•œ í‚¤ë“¤: ${Object.keys(localStorage).join(', ')}\n`;
                }
            } catch (error) {
                report += `ì˜¤ë¥˜ ë°œìƒ: ${error.message}\n`;
            }

            addResult('info', 'ğŸ§ª PWA ìŠ¤í¬ë¦½íŠ¸ ì‹œë®¬ë ˆì´ì…˜', report);
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ í™•ì¸
        window.addEventListener('load', () => {
            checkStorage();
        });
    </script>
</body>
</html>