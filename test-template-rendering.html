<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Rendering Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', 'Noto Sans KR', sans-serif; }
        .gradient-text {
            background-image: linear-gradient(45deg, #F57C00, #FFB74D);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .page-container { display: flex; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .page-content { flex-shrink: 0; width: 100%; }
        .nav-tab.active { color: #F57C00; font-weight: 700; border-color: #F57C00; }
        .bottom-sheet { transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .bottom-sheet.active { transform: translateY(0); }
        .overlay { opacity: 0; transition: opacity 0.4s ease; pointer-events: none; }
        .overlay.active { opacity: 1; pointer-events: auto; }
        .slider-arrow { opacity: 0; transition: opacity 0.3s ease; }
        .image-slider-container:hover .slider-arrow { opacity: 1; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div class="container mx-auto max-w-lg min-h-screen bg-white shadow-2xl shadow-slate-200 flex flex-col relative overflow-hidden">
        
        <!-- ìƒë‹¨ í—¤ë” (ê³ ì •) -->
        <header id="main-header" class="sticky top-0 z-20 bg-white/95 backdrop-blur-lg border-b border-slate-100">
            <div class="p-6 flex justify-between items-center">
                <div class="flex-1 min-w-0">
                    <h1 id="main-title" class="text-lg font-bold text-slate-900 truncate">ì•„ì´ì™€ í•¨ê»˜í•˜ëŠ” ì—¬ìœ ë¡œìš´ ë§ˆì¹´ì˜¤ ê°€ì¡± ì—¬í–‰</h1>
                    <p id="main-subtitle" class="text-xs text-slate-500 truncate">2024.07.30 - 2024.08.01 (2ë°• 3ì¼)</p>
                </div>
                <button class="w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 transition flex items-center justify-center flex-shrink-0 ml-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
                </button>
            </div>
            <!-- ìŠ¤í¬ë¡¤í˜• íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
            <div id="top-nav" class="px-4 border-t border-slate-100">
                <div class="flex items-center gap-4 overflow-x-auto no-scrollbar">
                    <button class="nav-tab flex-shrink-0 py-3 px-1 border-b-2 border-transparent text-sm font-medium text-slate-500 hover:text-slate-700 hover:border-slate-300 transition active" data-day="1">
                        DAY 1
                    </button>
                    <button class="nav-tab flex-shrink-0 py-3 px-1 border-b-2 border-transparent text-sm font-medium text-slate-500 hover:text-slate-700 hover:border-slate-300 transition" data-day="2">
                        DAY 2
                    </button>
                    <button class="nav-tab flex-shrink-0 py-3 px-1 border-b-2 border-transparent text-sm font-medium text-slate-500 hover:text-slate-700 hover:border-slate-300 transition" data-day="3">
                        DAY 3
                    </button>
                </div>
            </div>
        </header>

        <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ (ìŠ¤ì™€ì´í”„ ê°€ëŠ¥) -->
        <main class="flex-1 overflow-hidden">
            <div id="page-container" class="page-container h-full">
                <!-- Day 1 Page -->
                <div class="page-content h-full overflow-y-auto p-6">
                    <div class="mb-8">
                        <h2 class="text-3xl font-extrabold gradient-text">DAY 1</h2>
                        <p class="text-slate-500 font-medium">ë„ì°©ê³¼ ê·¸ëœë“œ ë¦¬ì¡°íŠ¸ ë±ì˜ ì¦ê±°ì›€</p>
                    </div>
                    
                    <div class="relative">
                        <div class="absolute left-4 top-2 bottom-2 w-0.5 bg-slate-200"></div>
                        <div class="space-y-8" id="day1-activities">
                            <!-- Activities will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Day 2 Page -->
                <div class="page-content h-full overflow-y-auto p-6">
                    <div class="mb-8">
                        <h2 class="text-3xl font-extrabold gradient-text">DAY 2</h2>
                        <p class="text-slate-500 font-medium">ë§ˆì¹´ì˜¤ì˜ ì—­ì‚¬ì™€ ì•„ì´ë“¤ì„ ìœ„í•œ ì¦ê±°ì›€</p>
                    </div>
                    
                    <div class="relative">
                        <div class="absolute left-4 top-2 bottom-2 w-0.5 bg-slate-200"></div>
                        <div class="space-y-8" id="day2-activities">
                            <!-- Activities will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Day 3 Page -->
                <div class="page-content h-full overflow-y-auto p-6">
                    <div class="mb-8">
                        <h2 class="text-3xl font-extrabold gradient-text">DAY 3</h2>
                        <p class="text-slate-500 font-medium">ë§ˆì§€ë§‰ ì¦ê±°ì›€ê³¼ ì•„ì‰¬ìš´ ì‘ë³„</p>
                    </div>
                    
                    <div class="relative">
                        <div class="absolute left-4 top-2 bottom-2 w-0.5 bg-slate-200"></div>
                        <div class="space-y-8" id="day3-activities">
                            <!-- Activities will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- ë– ìˆëŠ” í•˜ë‹¨ íƒ­ -->
        <nav class="fixed bottom-6 left-1/2 -translate-x-1/2 z-30">
            <div id="bottom-nav" class="flex items-center gap-2 bg-white/70 backdrop-blur-xl p-2 rounded-full shadow-lg ring-1 ring-black/5">
                <button data-sheet="info" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                    <span class="text-xs font-medium">ì •ë³´</span>
                </button>
                <button data-sheet="budget" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                     <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                    <span class="text-xs font-medium">ì˜ˆì‚°</span>
                </button>
                <button data-sheet="todo" class="bottom-nav-btn flex flex-col items-center justify-center gap-1 text-slate-500 hover:text-orange-600 transition w-20 h-14 rounded-full">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                    <span class="text-xs font-medium">ì¤€ë¹„ë¬¼</span>
                </button>
            </div>
        </nav>

        <!-- ë°”í…€ ì‹œíŠ¸ ì˜¤ë²„ë ˆì´ -->
        <div id="overlay" class="overlay fixed inset-0 bg-black/40 z-40"></div>

        <!-- ì •ë³´ ë°”í…€ ì‹œíŠ¸ -->
        <div id="sheet-info" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto" id="info-content">
                <!-- Info content will be loaded here -->
            </div>
        </div>
        
        <!-- ì˜ˆì‚° ë°”í…€ ì‹œíŠ¸ -->
        <div id="sheet-budget" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto" id="budget-content">
                <!-- Budget content will be loaded here -->
            </div>
        </div>

        <!-- ì¤€ë¹„ë¬¼ ë°”í…€ ì‹œíŠ¸ -->
        <div id="sheet-todo" class="bottom-sheet fixed bottom-0 left-0 right-0 z-50 bg-white rounded-t-2xl flex flex-col max-h-[85vh]">
            <div class="p-4 flex-shrink-0 border-b sticky top-0 bg-white rounded-t-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto"></div>
            </div>
            <div class="p-6 overflow-y-auto" id="todo-content">
                <!-- Todo content will be loaded here -->
            </div>
        </div>

    </div>

    <script>
        // Load test data
        const testData = {
            "tripMeta": {
                "destination": "Macau",
                "duration": "2ë°• 3ì¼",
                "startDate": "2024-07-30",
                "endDate": "2024-08-01",
                "tripType": "family"
            },
            "mainPlan": {
                "planName": "ì•„ì´ì™€ í•¨ê»˜í•˜ëŠ” ì—¬ìœ ë¡œìš´ ë§ˆì¹´ì˜¤ ê°€ì¡± ì—¬í–‰",
                "description": "37ê°œì›” ì•„ì´ì˜ ë¦¬ë“¬ì— ë§ì¶° ê·¸ëœë“œ ë¦¬ì¡°íŠ¸ ë±ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ê³„ëœ í¸ì•ˆí•˜ê³  ì¦ê±°ìš´ ê°€ì¡± ì—¬í–‰ ì¼ì •ì…ë‹ˆë‹¤.",
                "dailyPlans": [
                    {
                        "day": 1,
                        "dayTheme": "ë„ì°©ê³¼ ê·¸ëœë“œ ë¦¬ì¡°íŠ¸ ë±ì˜ ì¦ê±°ì›€",
                        "activities": [
                            {
                                "time": "14:00",
                                "duration": 90,
                                "type": "transport",
                                "title": "ë§ˆì¹´ì˜¤ ë„ì°© ë° ê°¤ëŸ­ì‹œ ë§ˆì¹´ì˜¤ ì²´í¬ì¸",
                                "description": "ë§ˆì¹´ì˜¤ êµ­ì œê³µí•­(MFM) ë„ì°© í›„, ê°¤ëŸ­ì‹œ ë§ˆì¹´ì˜¤ ë¬´ë£Œ ì…”í‹€ë²„ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ í˜¸í…”ë¡œ ì´ë™í•©ë‹ˆë‹¤.",
                                "placeDetails": {
                                    "name": "ê°¤ëŸ­ì‹œí˜¸í…”",
                                    "rating": 4.5,
                                    "photos": ["https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=ATKogpdhsZU_2nPihyShvPWJSLs_17L_6sxFpxNNEvViZ2uBwSc5Azh1rUi_-pupvKM0O0eIpEthfeGwt5n0mpMiJDdA5DCZbNHxuGn1fLgRcalAGJTTbyBMx9wgtoCP87OJ-agf71i77vCI9KUbMtaxt_fc7xClIkSkT3u-rcy8C8d5nGYce_fNut9sQ1IdL_OUPHhapYansK8OOGtgfH-mJFVA456tVhpWrctNdQfjf3hSjfhY6PsSUEqS5V7_96P4fLLojDjfRJbIiomAc9_Jd6OK3mhdIArAxQRL51lyAKXwbHvYKzA&key=AIzaSyDERW_lRSOP3dcot_xSIgiTWhHRX4U1RXU"],
                                    "reviews": "ìµœê³ ì˜ ì„œë¹„ìŠ¤ë¥¼ ì¶”êµ¬í•˜ëŠ” í˜¸í…”",
                                    "mapLink": "https://maps.google.com/?q=22.1489092,113.5543443"
                                },
                                "tips": ["ê³µí•­ì—ì„œ í˜¸í…” ì…”í‹€ë²„ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ í¸ë¦¬í•˜ê³  ë¬´ë£Œì…ë‹ˆë‹¤."]
                            },
                            {
                                "time": "16:00",
                                "duration": 180,
                                "type": "activity",
                                "title": "ê·¸ëœë“œ ë¦¬ì¡°íŠ¸ ë±ì—ì„œ ì‹ ë‚˜ëŠ” ë¬¼ë†€ì´",
                                "description": "ì•„ì´ì™€ í•¨ê»˜ ê·¸ëœë“œ ë¦¬ì¡°íŠ¸ ë±ì˜ íŒŒë„í’€, ìœ ìˆ˜í’€, ì›Œí„° ìŠ¬ë¼ì´ë“œ ë“± ë‹¤ì–‘í•œ ì‹œì„¤ì„ ì¦ê¸°ë©° ì‹œì›í•œ ì‹œê°„ì„ ë³´ëƒ…ë‹ˆë‹¤.",
                                "placeDetails": {
                                    "name": "ê°¤ëŸ­ì‹œí˜¸í…”",
                                    "rating": 4.5,
                                    "photos": ["https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=ATKogpdhsZU_2nPihyShvPWJSLs_17L_6sxFpxNNEvViZ2uBwSc5Azh1rUi_-pupvKM0O0eIpEthfeGwt5n0mpMiJDdA5DCZbNHxuGn1fLgRcalAGJTTbyBMx9wgtoCP87OJ-agf71i77vCI9KUbMtaxt_fc7xClIkSkT3u-rcy8C8d5nGYce_fNut9sQ1IdL_OUPHhapYansK8OOGtgfH-mJFVA456tVhpWrctNdQfjf3hSjfhY6PsSUEqS5V7_96P4fLLojDjfRJbIiomAc9_Jd6OK3mhdIArAxQRL51lyAKXwbHvYKzA&key=AIzaSyDERW_lRSOP3dcot_xSIgiTWhHRX4U1RXU"],
                                    "mapLink": "https://maps.google.com/?q=22.1489092,113.5543443"
                                },
                                "tips": ["ì–´ë¦° ì•„ì´ë¥¼ ìœ„í•œ êµ¬ëª…ì¡°ë¼ì™€ íŠœë¸Œë¥¼ ì¤€ë¹„í•˜ê±°ë‚˜ í˜„ì¥ì—ì„œ ëŒ€ì—¬ ê°€ëŠ¥í•©ë‹ˆë‹¤."]
                            }
                        ]
                    }
                ]
            },
            "budgetBreakdown": {
                "total": { "value": 1500000, "currency": "KRW" },
                "breakdown": [
                    { "category": "accommodation", "value": 800000, "description": "ê°¤ëŸ­ì‹œ ë§ˆì¹´ì˜¤ 2ë°•" },
                    { "category": "meals", "value": 400000, "description": "ì‹ì‚¬ ë¹„ìš©" },
                    { "category": "activities", "value": 200000, "description": "í™œë™ë¹„" },
                    { "category": "transport", "value": 100000, "description": "êµí†µë¹„" }
                ]
            },
            "essentialInfo": {
                "weather": "7ì›” ë§ ~ 8ì›” ì´ˆ ë§ˆì¹´ì˜¤ëŠ” ë§¤ìš° ë¥ê³  ìŠµí•˜ë©°, í‰ê·  ê¸°ì˜¨ì€ 28~32Â°Cì…ë‹ˆë‹¤.",
                "transportation": "ë§ˆì¹´ì˜¤ì˜ ì£¼ìš” í˜¸í…”ë“¤ì€ ê³µí•­ ë° í˜ë¦¬ í„°ë¯¸ë„ì—ì„œ ë¬´ë£Œ ì…”í‹€ë²„ìŠ¤ë¥¼ ìš´í–‰í•©ë‹ˆë‹¤.",
                "mustTryFood": ["ì—ê·¸íƒ€ë¥´íŠ¸", "í¬ë¥´íˆ¬ê°ˆì‹ ì¹˜í‚¨", "ë”¤ì„¬"],
                "localTips": ["ëŒ€ë¶€ë¶„ì˜ ë¦¬ì¡°íŠ¸ì™€ ì‡¼í•‘ëª°ì€ ì‹¤ë‚´ ì˜¨ë„ê°€ ë‚®ìœ¼ë‹ˆ ì–‡ì€ ê²‰ì˜·ì„ ê¼­ ì±™ê¸°ì„¸ìš”."]
            }
        };

        // Activity type configurations
        const activityConfig = {
            transport: { 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-2.2-1.8-4-4-4H6c-2.2 0-4 1.8-4 4v3c0 .6.4 1 1 1h2"></path><circle cx="9" cy="17" r="2"></circle><circle cx="15" cy="17" r="2"></circle></svg>`, 
                color: 'bg-blue-500',
                textColor: 'text-blue-600'
            },
            activity: { 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72z"></path><path d="m14 7 3 3"></path></svg>`, 
                color: 'bg-rose-500',
                textColor: 'text-rose-600'
            },
            meal: { 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M17 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"></path><path d="M3 13v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-8"></path></svg>`, 
                color: 'bg-amber-500',
                textColor: 'text-amber-600'
            }
        };

        // Render activity
        function renderActivity(activity) {
            const config = activityConfig[activity.type] || activityConfig.activity;
            const hasPhotos = activity.placeDetails?.photos?.length > 0;
            const hasPlaceDetails = !!activity.placeDetails;
            const hasTips = activity.tips?.length > 0;

            return `
                <div class="relative pl-12">
                    <div class="absolute left-0 top-1.5 flex items-center">
                        <div class="w-8 h-8 ${config.color} rounded-full flex items-center justify-center ring-4 ring-white">
                            ${config.icon}
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-slate-100 shadow-sm">
                        <p class="text-sm font-semibold ${config.textColor} mb-1">${activity.time} (${activity.duration}ë¶„)</p>
                        <h3 class="text-lg font-bold mb-3">${activity.title}</h3>
                        
                        ${hasPhotos ? `
                        <div class="relative -mx-5 mb-4 rounded-lg overflow-hidden">
                            <div class="flex overflow-x-auto snap-x snap-mandatory no-scrollbar">
                                ${activity.placeDetails.photos.map(photo => `
                                    <div class="snap-center flex-shrink-0 w-full">
                                        <img src="${photo}" class="w-full h-auto" alt="${activity.placeDetails.name}" loading="lazy">
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                        
                        <p class="text-sm text-slate-600 leading-relaxed mb-4">${activity.description}</p>
                        
                        ${hasPlaceDetails ? `
                        <div class="space-y-3 pt-2">
                            ${activity.placeDetails.rating ? `
                            <div class="flex items-center gap-2">
                                <span class="font-bold text-amber-500">${activity.placeDetails.rating}</span>
                                <div class="flex text-amber-400">${renderStars(activity.placeDetails.rating)}</div>
                            </div>
                            ` : ''}
                            
                            <div class="mt-4 flex gap-3">
                                <a href="${activity.placeDetails.mapLink}" target="_blank" class="flex-1 text-center bg-orange-50 text-orange-700 text-sm font-bold py-2 px-4 rounded-lg hover:bg-orange-100 transition">ì§€ë„ ë³´ê¸°</a>
                            </div>
                        </div>
                        ` : ''}
                        
                        ${hasTips ? `
                        <div class="mt-4 border-t border-slate-100 pt-3">
                            <h4 class="text-xs font-bold text-slate-500 mb-2">ğŸ’¡ ì „ë¬¸ê°€ íŒ</h4>
                            <ul class="list-disc list-inside text-xs text-slate-500 space-y-1">
                                ${activity.tips.map(tip => `<li>${tip}</li>`).join('')}
                            </ul>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // Render stars
        function renderStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let starsHtml = '';
            
            for (let i = 0; i < fullStars; i++) {
                starsHtml += '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
            }
            
            if (hasHalfStar) {
                starsHtml += '<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><defs><linearGradient id="half"><stop offset="50%" stop-color="currentColor"/><stop offset="50%" stop-color="#e2e8f0"/></linearGradient></defs><path fill="url(#half)" d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
            }
            
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            for (let i = 0; i < emptyStars; i++) {
                starsHtml += '<svg class="w-4 h-4 text-slate-300" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
            }
            
            return starsHtml;
        }

        // Load activities for Day 1
        function loadDay1Activities() {
            const day1Container = document.getElementById('day1-activities');
            const day1Data = testData.mainPlan.dailyPlans[0];
            
            day1Container.innerHTML = day1Data.activities.map(activity => renderActivity(activity)).join('');
        }

        // Load info content
        function loadInfoContent() {
            const infoContainer = document.getElementById('info-content');
            const info = testData.essentialInfo;
            
            infoContainer.innerHTML = `
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ì—¬í–‰ ì •ë³´</h2>
                <div class="space-y-4">
                    <div class="p-5 bg-blue-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 22a7 7 0 0 0 7-7c0-2-1-3-3-4-1.5-1.5-3-2-3-4 0-2 2-2 2-2"></path>
                                <path d="M8.5 2.5a2.5 2.5 0 0 1 5 0"></path>
                                <path d="M12 22V8"></path>
                            </svg> 
                            êµí†µí¸
                        </h3>
                        <p class="text-sm text-slate-600">${info.transportation}</p>
                    </div>

                    <div class="p-5 bg-yellow-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                            </svg> 
                            ì—¬í–‰ íŒ
                        </h3>
                        <div class="text-sm text-slate-600 leading-relaxed">
                            ${info.localTips.map(tip => `<p class="mb-2">â€¢ ${tip}</p>`).join('')}
                        </div>
                    </div>

                    <div class="p-5 bg-red-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg> 
                            ë‚ ì”¨ ì •ë³´
                        </h3>
                        <p class="text-sm text-slate-600 leading-relaxed">${info.weather}</p>
                    </div>

                    <div class="p-5 bg-purple-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="2" y1="12" x2="22" y2="12"></line>
                                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                            </svg> 
                            í˜„ì§€ ë¬¸í™” íŒ
                        </h3>
                        <div class="text-sm text-slate-600 leading-relaxed">
                            <p class="font-semibold mb-2">ê¼­ ë¨¹ì–´ë´ì•¼ í•  ìŒì‹:</p>
                            <p>${info.mustTryFood.join(', ')}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load budget content
        function loadBudgetContent() {
            const budgetContainer = document.getElementById('budget-content');
            const budget = testData.budgetBreakdown;
            
            budgetContainer.innerHTML = `
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ì—¬í–‰ ì˜ˆì‚°</h2>
                <div class="space-y-6">
                    <div class="bg-slate-100 p-5 rounded-xl">
                        <div class="flex justify-between items-center mb-2">
                            <div>
                                <h3 class="font-bold text-slate-800 flex items-center gap-2">
                                    ì´ ì˜ˆì‚°
                                </h3>
                                <p class="text-xs text-slate-500">â‚©${budget.total.value.toLocaleString()}</p>
                            </div>
                            <span class="font-bold text-orange-600 text-lg">â‚©0</span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-2.5">
                            <div class="bg-gradient-to-r from-orange-400 to-amber-500 h-2.5 rounded-full transition-all" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <h3 class="font-bold text-slate-800 border-b pb-2">ì˜ˆìƒ ë¹„ìš© ë¶„ì„</h3>
                        
                        ${budget.breakdown.map((item, index) => {
                            const colors = ['blue', 'green', 'amber', 'purple'];
                            const color = colors[index % colors.length];
                            return `
                            <div class="p-4 bg-${color}-50 rounded-lg border border-${color}-100">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium text-slate-700">${item.category === 'accommodation' ? 'ìˆ™ë°•ë¹„' : 
                                                                            item.category === 'meals' ? 'ì‹ë¹„' :
                                                                            item.category === 'activities' ? 'ê´€ê´‘/í™œë™ë¹„' : 'êµí†µë¹„'}</span>
                                    <span class="font-bold text-${color}-600">â‚©${item.value.toLocaleString()}</span>
                                </div>
                                <p class="text-xs text-slate-500">${item.description}</p>
                            </div>
                            `;
                        }).join('')}
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">ì‹¤ì œ ì§€ì¶œ ë‚´ì—­</h3>
                        <div class="space-y-3" id="expense-list">
                            <p class="text-center text-slate-400 py-8">ì•„ì§ ì§€ì¶œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-800 mt-8 mb-4 border-b pb-2">ì§€ì¶œ ì¶”ê°€</h3>
                        <div class="space-y-3">
                            <input type="text" placeholder="í•­ëª© (ì˜ˆ: ì €ë… ì‹ì‚¬)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <button class="w-full bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">ì¶”ê°€í•˜ê¸°</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load todo content
        function loadTodoContent() {
            const todoContainer = document.getElementById('todo-content');
            
            todoContainer.innerHTML = `
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ì—¬í–‰ ì¤€ë¹„ë¬¼</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">âœˆï¸ ì¶œë°œ ì „ í•„ìˆ˜</h3>
                        <div class="space-y-3">
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ì—¬ê¶Œ ë° í•­ê³µí¸ í‹°ì¼“</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ìˆ™ì†Œ ë°”ìš°ì²˜ ì¶œë ¥ ë˜ëŠ” ì €ì¥</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">í™ì½©ë‹¬ëŸ¬ í™˜ì „</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">í•´ì™¸ ë°ì´í„° ë¡œë° ë˜ëŠ” ìœ ì‹¬</span>
                            </label>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">ğŸ‘• ê°œì¸ ìš©í’ˆ</h3>
                        <div class="space-y-3">
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ë‚ ì”¨ì— ë§ëŠ” ì˜·ì°¨ë¦¼</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">í¸í•œ ì‹ ë°œ (ë§ì´ ê±¸ì„ ì˜ˆì •)</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ê°œì¸ ì„¸ë©´ìš©í’ˆ</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ìƒë¹„ì•½ (ë‘í†µì•½, ì†Œí™”ì œ ë“±)</span>
                            </label>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">ğŸ‘¶ ì•„ì´ ìš©í’ˆ</h3>
                        <div class="space-y-3">
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ê¸°ì €ê·€, ë¬¼í‹°ìŠˆ, íœ´ëŒ€ìš© ë³€ê¸° ì»¤ë²„</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ì•„ì´ ì „ìš© ìƒë¹„ì•½ (í•´ì—´ì œ, ì²´ì˜¨ê³„, ë°´ë“œ)</span>
                            </label>
                            <label class="flex items-center gap-3 p-4 bg-white rounded-lg border border-slate-200 shadow-sm">
                                <input type="checkbox" class="h-5 w-5 rounded border-slate-300 text-orange-600 focus:ring-orange-500">
                                <span class="text-sm text-slate-700">ì•„ì´ê°€ ì¢‹ì•„í•˜ëŠ” ê°„ì‹ê³¼ ì¥ë‚œê°</span>
                            </label>
                        </div>
                    </div>

                    <div class="mt-8 flex gap-2">
                        <input type="text" placeholder="ìƒˆ ì¤€ë¹„ë¬¼ ì¶”ê°€" class="flex-1 p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                        <button class="bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">ì¶”ê°€</button>
                    </div>
                </div>
            `;
        }

        // Navigation functionality
        let currentPageIndex = 0;
        const pages = document.querySelectorAll('.page-content');
        const navTabs = document.querySelectorAll('.nav-tab');
        const pageContainer = document.getElementById('page-container');

        function showPage(index) {
            currentPageIndex = index;
            pageContainer.style.transform = `translateX(-${index * 100}%)`;
            
            navTabs.forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });
        }

        // Tab navigation
        navTabs.forEach((tab, index) => {
            tab.addEventListener('click', () => showPage(index));
        });

        // Bottom sheet functionality
        const bottomNavBtns = document.querySelectorAll('.bottom-nav-btn');
        const overlay = document.getElementById('overlay');
        const sheets = document.querySelectorAll('.bottom-sheet');

        function showBottomSheet(sheetId) {
            // Hide all sheets first
            sheets.forEach(sheet => sheet.classList.remove('active'));
            overlay.classList.remove('active');
            
            // Show selected sheet
            setTimeout(() => {
                const targetSheet = document.getElementById(`sheet-${sheetId}`);
                if (targetSheet) {
                    targetSheet.classList.add('active');
                    overlay.classList.add('active');
                }
            }, 10);
        }

        function hideBottomSheets() {
            sheets.forEach(sheet => sheet.classList.remove('active'));
            overlay.classList.remove('active');
        }

        bottomNavBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const sheetId = btn.dataset.sheet;
                showBottomSheet(sheetId);
            });
        });

        overlay.addEventListener('click', hideBottomSheets);

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadDay1Activities();
            loadInfoContent();
            loadBudgetContent();
            loadTodoContent();
            showPage(0);
        });
    </script>
    
    <!-- PWA Storage & Manual Input System -->
    <script src="pwa-storage-system.js"></script>
    <script src="manual-input-ui.js"></script>
    <script>
        // PWA Storage & Manual Input ì´ˆê¸°í™”
        let storageManager;
        let manualInputUI;

        // ì¡°ê±´ë¶€ ë Œë”ë§ì„ ìœ„í•œ í…œí”Œë¦¿ ë³€ìˆ˜ ì²˜ë¦¬
        function processConditionalRendering(template, data) {
            const ifPattern = /\{\{#if\s+(\w+)\}\}([\s\S]*?)(?:\{\{else\}\}([\s\S]*?))?\{\{\/if\}\}/g;
            
            return template.replace(ifPattern, (match, condition, ifContent, elseContent = '') => {
                const shouldShow = evaluateCondition(condition, data);
                return shouldShow ? ifContent : elseContent;
            });
        }

        function evaluateCondition(condition, data) {
            switch(condition) {
                case 'HAS_TRANSPORT_INFO':
                    return data.transport && data.transport.route;
                case 'HAS_BUDGET_BREAKDOWN':
                    return data.budget && data.budget.breakdown && Object.keys(data.budget.breakdown).length > 0;
                default:
                    return false;
            }
        }

        function replaceTemplateVariables(template, variables) {
            let result = template;
            Object.keys(variables).forEach(key => {
                const pattern = new RegExp(`\\{\\{${key}\\}\\}`, 'g');
                result = result.replace(pattern, variables[key] || '');
            });
            return result;
        }

        // ì‚¬ìš©ì ë°ì´í„°ë¡œ ë³´ì™„
        function enhanceWithUserData(templateData) {
            if (!storageManager) return templateData;

            const transportInfo = storageManager.getTransportInfo();
            const budgetInfo = storageManager.getBudgetInfo();

            if (transportInfo.isManuallyAdded && transportInfo.label) {
                templateData.transport = {
                    label: transportInfo.label,
                    route: transportInfo.route,
                    schedule: transportInfo.schedule,
                    isUserGenerated: true
                };
            }

            if (budgetInfo.isManuallySet && budgetInfo.total > 0) {
                templateData.budget = {
                    total: budgetInfo.total,
                    breakdown: budgetInfo.breakdown,
                    expenses: budgetInfo.expenses,
                    isUserGenerated: true
                };
            }

            return templateData;
        }

        // Enhanced info content loading with conditional rendering
        function loadInfoContentEnhanced() {
            const infoContainer = document.getElementById('info-content');
            const info = testData.essentialInfo;
            
            const enhancedData = enhanceWithUserData({
                transport: { label: "êµí†µí¸", route: "", schedule: "" }
            });

            const templateVars = {
                HAS_TRANSPORT_INFO: !!enhancedData.transport?.route,
                TRANSPORT_LABEL: enhancedData.transport?.label || "êµí†µí¸",
                TRANSPORT_ROUTE: enhancedData.transport?.route || "",
                TRANSPORT_SCHEDULE: enhancedData.transport?.schedule || ""
            };

            let template = `
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ì—¬í–‰ ì •ë³´</h2>
                <div class="space-y-4">
                    {{#if HAS_TRANSPORT_INFO}}
                    <div class="p-5 bg-blue-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 22a7 7 0 0 0 7-7c0-2-1-3-3-4-1.5-1.5-3-2-3-4 0-2 2-2 2-2"></path>
                                <path d="M8.5 2.5a2.5 2.5 0 0 1 5 0"></path>
                                <path d="M12 22V8"></path>
                            </svg> 
                            {{TRANSPORT_LABEL}}
                        </h3>
                        <p class="text-sm text-slate-600">{{TRANSPORT_ROUTE}}</p>
                        <p class="text-sm text-slate-500 mt-1">{{TRANSPORT_SCHEDULE}}</p>
                        
                        <div class="mt-3 pt-2 border-t border-blue-100">
                            <button class="add-transport-btn text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                ìˆ˜ì •í•˜ê¸°
                            </button>
                        </div>
                    </div>
                    {{else}}
                    <div class="p-5 bg-blue-50 rounded-xl border-2 border-dashed border-blue-200">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 22a7 7 0 0 0 7-7c0-2-1-3-3-4-1.5-1.5-3-2-3-4 0-2 2-2 2-2"></path>
                                <path d="M8.5 2.5a2.5 2.5 0 0 1 5 0"></path>
                                <path d="M12 22V8"></path>
                            </svg> 
                            {{TRANSPORT_LABEL}} ì •ë³´
                        </h3>
                        <p class="text-sm text-slate-500 mb-3">êµí†µí¸ ì •ë³´ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”</p>
                        <button class="add-transport-btn bg-blue-500 text-white text-xs font-medium py-2 px-3 rounded-lg hover:bg-blue-600 transition">
                            + ì •ë³´ ì¶”ê°€í•˜ê¸°
                        </button>
                    </div>
                    {{/if}}

                    <div class="p-5 bg-yellow-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                            </svg> 
                            ì—¬í–‰ íŒ
                        </h3>
                        <div class="text-sm text-slate-600 leading-relaxed">
                            ${info.localTips.map(tip => `<p class="mb-2">â€¢ ${tip}</p>`).join('')}
                        </div>
                    </div>

                    <div class="p-5 bg-red-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg> 
                            ë‚ ì”¨ ì •ë³´
                        </h3>
                        <p class="text-sm text-slate-600 leading-relaxed">${info.weather}</p>
                    </div>

                    <div class="p-5 bg-purple-50 rounded-xl">
                        <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="2" y1="12" x2="22" y2="12"></line>
                                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                            </svg> 
                            í˜„ì§€ ë¬¸í™” íŒ
                        </h3>
                        <div class="text-sm text-slate-600 leading-relaxed">
                            <p class="font-semibold mb-2">ê¼­ ë¨¹ì–´ë´ì•¼ í•  ìŒì‹:</p>
                            <p>${info.mustTryFood.join(', ')}</p>
                        </div>
                    </div>
                </div>
            `;

            template = processConditionalRendering(template, templateVars);
            template = replaceTemplateVariables(template, templateVars);
            infoContainer.innerHTML = template;
        }

        // Enhanced budget content loading
        function loadBudgetContentEnhanced() {
            const budgetContainer = document.getElementById('budget-content');
            const budget = testData.budgetBreakdown;
            
            const enhancedData = enhanceWithUserData({ budget: budget });
            const templateVars = {
                HAS_BUDGET_BREAKDOWN: !!(enhancedData.budget?.breakdown && Object.keys(enhancedData.budget.breakdown).length > 0),
                TOTAL_BUDGET_DISPLAY: enhancedData.budget?.total ? `â‚©${enhancedData.budget.total.toLocaleString()}` : (budget?.total?.value ? `â‚©${budget.total.value.toLocaleString()}` : 'â‚©0'),
                CURRENT_EXPENSE: 'â‚©0',
                EXPENSE_PERCENTAGE: '0'
            };

            let template = `
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ì—¬í–‰ ì˜ˆì‚°</h2>
                <div class="space-y-6">
                    <div class="bg-slate-100 p-5 rounded-xl">
                        <div class="flex justify-between items-center mb-2">
                            <div>
                                <h3 class="font-bold text-slate-800 flex items-center gap-2">
                                    ì´ ì˜ˆì‚°
                                    <button class="add-transport-btn text-slate-400 hover:text-orange-500">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.536l12.232-12.232z"></path>
                                        </svg>
                                    </button>
                                </h3>
                                <p class="text-xs text-slate-500">{{TOTAL_BUDGET_DISPLAY}}</p>
                            </div>
                            <span class="font-bold text-orange-600 text-lg">{{CURRENT_EXPENSE}}</span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-2.5">
                            <div class="bg-gradient-to-r from-orange-400 to-amber-500 h-2.5 rounded-full transition-all" style="width: {{EXPENSE_PERCENTAGE}}%"></div>
                        </div>
                    </div>

                    {{#if HAS_BUDGET_BREAKDOWN}}
                    <div class="space-y-3">
                        <h3 class="font-bold text-slate-800 border-b pb-2">ì˜ˆìƒ ë¹„ìš© ë¶„ì„</h3>
                        ${budget.breakdown.map((item, index) => {
                            const colors = ['blue', 'green', 'amber', 'purple'];
                            const color = colors[index % colors.length];
                            return `
                            <div class="p-4 bg-${color}-50 rounded-lg border border-${color}-100">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-medium text-slate-700">${item.category === 'accommodation' ? 'ìˆ™ë°•ë¹„' : 
                                                                            item.category === 'meals' ? 'ì‹ë¹„' :
                                                                            item.category === 'activities' ? 'ê´€ê´‘/í™œë™ë¹„' : 'êµí†µë¹„'}</span>
                                    <span class="font-bold text-${color}-600">â‚©${item.value.toLocaleString()}</span>
                                </div>
                                <p class="text-xs text-slate-500">${item.description}</p>
                            </div>
                            `;
                        }).join('')}
                    </div>
                    {{else}}
                    <div class="p-6 bg-slate-50 rounded-xl border-2 border-dashed border-slate-200 text-center">
                        <div class="mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mx-auto text-slate-400">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <h3 class="font-bold text-slate-800 mb-2">ì˜ˆì‚° ê³„íšì„ ì„¸ì›Œë³´ì„¸ìš”</h3>
                        <p class="text-sm text-slate-500 mb-4">AIê°€ ì œì•ˆí•˜ëŠ” ì˜ˆì‚° ë¶„ì„ì´ ì—†ìŠµë‹ˆë‹¤.<br>ì§ì ‘ ì˜ˆì‚°ì„ ì„¤ì •í•˜ê³  ì§€ì¶œì„ ê´€ë¦¬í•´ë³´ì„¸ìš”.</p>
                        <button class="setup-budget-btn bg-orange-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-orange-600 transition">
                            ì˜ˆì‚° ì„¤ì •í•˜ê¸°
                        </button>
                    </div>
                    {{/if}}

                    <div>
                        <h3 class="font-bold text-slate-800 mb-4 border-b pb-2">ì‹¤ì œ ì§€ì¶œ ë‚´ì—­</h3>
                        <div class="space-y-3" id="expense-list">
                            <p class="text-center text-slate-400 py-8">ì•„ì§ ì§€ì¶œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>

                    <div>
                        <h3 class="font-bold text-slate-800 mt-8 mb-4 border-b pb-2">ì§€ì¶œ ì¶”ê°€</h3>
                        <div class="space-y-3">
                            <input type="text" placeholder="í•­ëª© (ì˜ˆ: ì €ë… ì‹ì‚¬)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="w-full p-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <button class="w-full bg-orange-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 transition">ì¶”ê°€í•˜ê¸°</button>
                        </div>
                    </div>
                </div>
            `;

            template = processConditionalRendering(template, templateVars);
            template = replaceTemplateVariables(template, templateVars);
            budgetContainer.innerHTML = template;
        }

        // í™•ì¥ëœ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            // ìŠ¤í† ë¦¬ì§€ ë§¤ë‹ˆì € ì´ˆê¸°í™”
            storageManager = new PWAStorageManager('test_macau_trip');
            manualInputUI = new ManualInputUI(storageManager);
            
            console.log('PWA Storage initialized:', storageManager.getStorageUsage());
            
            // ê¸°ë³¸ ì½˜í…ì¸  ëŒ€ì‹  í™•ì¥ëœ ì½˜í…ì¸  ë¡œë”©
            setTimeout(() => {
                loadInfoContentEnhanced();
                loadBudgetContentEnhanced();
            }, 100);
        });
    </script>
</body>
</html>